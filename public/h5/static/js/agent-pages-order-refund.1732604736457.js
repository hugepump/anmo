(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["agent-pages-order-refund"],{"005c":function(e,r,t){"use strict";var n=t("b684"),i=t.n(n);i.a},"18c0":function(e,r,t){var n=t("c86c");r=n(!1),r.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.user-order-refund .icon-xuanze[data-v-3809edcc],\n.user-order-refund .icon-xuanze-fill[data-v-3809edcc]{font-size:%?38?%}.user-order-refund .item-child .goods-img[data-v-3809edcc]{width:%?147?%;height:%?147?%;border-radius:%?26?%}.user-order-refund .item-child .goods-num[data-v-3809edcc]{width:%?200?%}.user-order-refund .item-child .textarea-info[data-v-3809edcc]{background:#f7f7f7}.user-order-refund .item-child .textarea-info .input-textarea[data-v-3809edcc]{width:%?570?%;height:%?300?%}.user-order-refund .item-child.b-1px-b[data-v-3809edcc]:after{left:%?58?%}.user-order-refund .refund-bottom-info[data-v-3809edcc]{bottom:0}.user-order-refund .refund-bottom-info .iconfont[data-v-3809edcc]{font-size:%?38?%}.user-order-refund .refund-bottom-info .flex-between[data-v-3809edcc]{height:%?122?%}.user-order-refund .refund-bottom-info .flex-between .order[data-v-3809edcc]{width:%?189?%;height:%?76?%;color:#333;font-size:%?30?%;border-radius:%?50?%;border:%?1?% solid #c7c7c7}',""]),e.exports=r},"4afa":function(e,r,t){"use strict";t("6a54");var n=t("f5bd").default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,t("fd3c"),t("8f71"),t("bf0f"),t("5c47"),t("0506"),t("d4b5"),t("aa9c");var i=n(t("2634")),a=n(t("2fdc")),c=n(t("9b1b")),s=t("8f59"),o={components:{},data:function(){return{isLoad:!1,options:{},statusType:{"-1":"已取消",1:"待支付",2:"待接单",3:"已接单",4:"已出发",5:"已到达",6:"服务中",7:"已完成",8:"待转单"},refundForm:{},refund_balance:"",timer:null,lockTap:!1}},computed:(0,s.mapState)({configInfo:function(e){return e.config.configInfo}}),onLoad:function(e){var r=e.agent,t=void 0===r?0:r;e.agent=1*t,this.options=e,this.initIndex()},destroyed:function(){this.timer&&clearInterval(this.timer)},methods:(0,c.default)((0,c.default)((0,c.default)({},(0,s.mapActions)(["getConfigInfo","getCoachInfo"])),(0,s.mapMutations)(["updateTechnicianItem"])),{},{initIndex:function(){var e=arguments,r=this;return(0,a.default)((0,i.default)().mark((function t(){var n,a,c,s,o,d,u,l,_,f,m;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.length>0&&void 0!==e[0]&&e[0],r.configInfo.id&&!n){t.next=4;break}return t.next=4,r.getConfigInfo();case 4:return r.$util.setNavigationBarColor({bg:r.primaryColor}),a=r.options,c=a.id,s=a.agent,o=s?"agent":"admin",t.prev=7,t.next=10,r.$api[o].canRefundOrderInfo({order_id:c});case 10:d=t.sent,u=d.empty_order_cash,l=d.order[0].pay_type,u=5===l?u:0,d.refund_empty_cash=u,d.empty_order_cash=u,d.init_empty_order_cash=u,d.is_check=!1,d.refund_car_price=d.car_price,d.total_refund_price=0,d.all_refund_num=0,_=r.$util.DateToUnix(r.$util.formatTime(new Date,"YY-M-D h:m:s")),f=0,m=0,d.order.map((function(e){var t=0;if(e.pay_type>5&&1===d.after_service_can_refund){var n=Math.ceil((_-e.start_service_time)/60),i=d.cash_list.filter((function(e){return e.minute>=n})),a=i&&i.length>0?i[0]:d.cash_list[d.cash_list.length-1],c=a.balance;t=c}e.refund_comm_balance=t,e.order_goods.map((function(r){var n=r.residue_material_price,i=r.residue_service_price,a=r.can_refund_num,c=r.true_price,s=r.material_price;a&&m++;var o=0;f+=a,r.is_check=!1,r.true_single_price=c,r.true_single_material_price=s,c=(i/a).toFixed(2),s=(n/a).toFixed(2),r.true_price=c,r.material_price=s,r.refund_price=c,r.refund_material_price=s,e.pay_type>5&&1==d.after_service_can_refund&&(o=((1*c+1*s)*t/100).toFixed(2),r.refund_comm_price=o,r.refund_comm_cash=o);var u=1*((1*c+1*s-1*o)*a).toFixed(2),l=1*(1*i+1*n-o*a).toFixed(2);r.total_refund_price=u>l?l:u,r.true_total_refund_price=l,r.refund_num=a})),e.time_text=r.$util.formatTime(1e3*e.start_time,"YY-M-D h:m")+" - "+r.$util.formatTime(1e3*e.end_time,"YY-M-D h:m")})),d.can_refund_num=f,f||(d.total_refund_price=d.car_price),d.order=d.order.filter((function(e){return e.order_goods.length>0})),d.is_car_check=!1,d.is_empty_check=!1,r.refundForm=d,1===m&&r.handleCheckOrderItem(2),r.isLoad=!0,l>5&&1==d.after_service_can_refund&&(r.timer=setInterval((function(){r.handleCheckOrderItem(-1)}),6e4)),n||r.$jweixin.hideOptionMenu(),t.next=40;break;case 37:t.prev=37,t.t0=t["catch"](7),setTimeout((function(){r.$util.back(),r.$util.getPage(-2).initRefresh(),r.$util.goUrl({url:1,openType:"navigateBack"})}),2e3);case 40:case"end":return t.stop()}}),t,null,[[7,37]])})))()},initRefresh:function(){this.initIndex(!0)},changeNum:function(e,r,t){var n=this;return(0,a.default)((0,i.default)().mark((function a(){var c,s,o,d;return(0,i.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(c=n.refundForm.order[e].order_goods[r],s=c.refund_num,o=c.can_refund_num,d=s+t,!(d>o||d<1)){i.next=5;break}return n.$util.showToast({title:d?"数量不可大于".concat(o):"数量至少为1"}),i.abrupt("return");case 5:n.refundForm.order[e].order_goods[r].refund_num=d,n.handleCheckOrderItem(0,e,r);case 7:case"end":return i.stop()}}),a)})))()},checkInput:function(e,r,t,n){var i=this,a=this.$util.formatMoney(e.detail.value);this.$nextTick((function(){-1==r?i.refundForm[n]=a:i.refundForm.order[r].order_goods[t][n]=a}))},handleCheckOrderItem:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.refundForm,a=i.is_check,c=i.order,s=i.can_refund_num,o=i.is_car_check,d=i.refund_car_price,u=i.car_price,l=i.is_empty_check,_=i.refund_empty_cash,f=i.empty_order_cash,m=i.init_empty_order_cash,p=i.after_service_can_refund,v=i.cash_list;if(1==r){var h=this.refundForm.order[t].order_goods[n].is_check;this.refundForm.order[t].order_goods[n].is_check=!h}if(2==r&&this.refundForm.order.map((function(e){e.order_goods.map((function(e){e.is_check=!a}))})),3==r){var g=/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;g.test(d)||(d=0),1*d>1*u&&(d=u),this.$nextTick((function(){e.refundForm.refund_car_price=d}))}if(4==r&&(o=!o,this.$nextTick((function(){e.refundForm.is_car_check=o}))),5==r){var C=/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;C.test(_)||(_=0),1*_>1*f&&(_=f),this.$nextTick((function(){e.refundForm.refund_empty_cash=_}))}if(6==r&&(l=!l,this.$nextTick((function(){e.refundForm.is_empty_check=l}))),0==r){var x=c[t].order_goods[n],w=x.residue_service_price,b=x.residue_material_price,y=x.true_single_price,k=x.true_single_material_price,F=x.can_refund_num,$=x.refund_num,I=x.refund_price,T=x.refund_material_price,E=x.true_total_refund_price,O=x.refund_comm_price,A=x.refund_comm_cash,D=c[t],z=D.pay_type,M=D.start_service_time,S=D.refund_comm_balance,Y=/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;if(Y.test(I)&&1*I!=0||(I=1*w===0?0:.01),Y.test(T)||(T=0),Y.test(A)||(A=0),y=F===$?(1*w/$).toFixed(2):y,k=F===$?(1*b/$).toFixed(2):k,I=1*I>1*y?y:I,T=1*T>1*k?k:T,p&&z>5){var N=this.$util.DateToUnix(this.$util.formatTime(new Date,"YY-M-D h:m:s")),P=Math.ceil((N-M)/60),R=v.filter((function(e){return e.minute>=P})),j=R&&R.length>0?R[0]:v[v.length-1],U=j.balance;S=U,O=((1*I+1*T)*U/100).toFixed(2),A=A>O?O:A}var B=((1*I+1*T-1*A)*$).toFixed(2);this.$nextTick((function(){e.refundForm.order[t].order_goods[n].true_price=y,e.refundForm.order[t].order_goods[n].refund_price=I,e.refundForm.order[t].order_goods[n].material_price=k,e.refundForm.order[t].order_goods[n].refund_material_price=T,e.refundForm.order[t].refund_comm_balance=S,e.refundForm.order[t].order_goods[n].refund_comm_price=O,e.refundForm.order[t].order_goods[n].refund_comm_cash=A,e.refundForm.order[t].order_goods[n].total_refund_price=1*B>E?E:B}))}this.$nextTick((function(){var r=0,t=0,n=0;e.refundForm.order.map((function(i){var a=i.pay_type,c=i.start_service_time,s=0;if(p&&a>5){var o=e.$util.DateToUnix(e.$util.formatTime(new Date,"YY-M-D h:m:s")),d=Math.ceil((o-c)/60),u=v.filter((function(e){return e.minute>=d})),l=u&&u.length>0?u[0]:v[v.length-1],_=l.balance;s=_}i.refund_comm_balance=s,i.order_goods.map((function(e){var i=e.refund_num,c=e.refund_price,o=e.refund_material_price;if(p&&a>5){var d=((1*c+1*o)*s/100).toFixed(2),u=1*e.refund_comm_cash>d?d:e.refund_comm_cash;e.refund_comm_price=d,e.refund_comm_cash=u,e.total_refund_price=((1*c+1*o-1*u)*i).toFixed(2)}e.is_check?(r+=1*e.total_refund_price,t+=i):n++}))}));var i=s===t;o=!!i&&o,l=!!i&&l,i&&1*r<m&&(f=r,_=1*_>r?r:_);var a=o?d:0,c=l?-1*f+1*_:i?-1*f:0,u=1*r+(1*a+1*c);e.refundForm.total_refund_price=u.toFixed(2),e.refundForm.all_refund_num=t,e.refundForm.is_check=0===n,e.refundForm.is_car_check=o,e.refundForm.is_empty_check=l,e.refundForm.refund_car_price=d,e.refundForm.empty_order_cash=f,e.refundForm.refund_empty_cash=_}))},toConfirmRefund:function(){var e=this;return(0,a.default)((0,i.default)().mark((function r(){var t,n,a,c,s,o,d,u,l,_,f,m,p,v,h;return(0,i.default)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.handleCheckOrderItem(-1);case 2:if(t=JSON.parse(JSON.stringify(e.refundForm)),n=t.can_refund_num,a=t.all_refund_num,c=t.is_car_check,s=t.refund_car_price,o=t.is_empty_check,d=t.empty_order_cash,u=t.refund_empty_cash,l=t.order,s=c?s:0,u=o?u:0,d=n===a?d:0,_=[],f=0,m=0,p=l.filter((function(e){return!e.is_add})),!(p.length>0)){r.next=16;break}if(p[0].order_goods.map((function(e){f+=e.can_refund_num,e.is_check&&(m+=e.refund_num)})),f!==m||n===a){r.next=16;break}return e.$util.showToast({title:"请把加钟项目一并退款哦"}),r.abrupt("return");case 16:if(l.map((function(e){var r=e.order_goods.filter((function(e){return e.is_check}));if(r.length>0){var t=r.map((function(e){var r=e.refund_num,t=e.refund_price,n=e.refund_material_price,i=e.residue_service_price,a=e.residue_material_price,c=e.refund_comm_cash,s=void 0===c?0:c,o=1*(t*r).toFixed(2),d=1*(n*r).toFixed(2),u=s?1*(s*r).toFixed(2):0;return{id:e.id,num:r,true_price:o>i?i:o,material_price:d>a?a:d,refund_comm_cash:u}})),n=e.order_id,i=e.is_add,a=e.refund_comm_balance,c=void 0===a?0:a;_.push({order_id:n,list:t,car_price:i?0:s,comm_balance:c,refund_empty_cash:i?0:(1*d-1*u).toFixed(2),apply_empty_cash:i?0:u})}})),0===_.length&&_.push({order_id:l[0].order_id,list:[],car_price:s}),v=e.options.agent,h=v?"agent":"admin",!e.lockTap){r.next=22;break}return r.abrupt("return");case 22:return e.lockTap=!0,e.$util.showLoading(),r.prev=24,r.next=27,e.$api[h].applyOrderRefund({order:_});case 27:e.$util.hideAll(),e.$util.showToast({title:"操作成功"}),setTimeout((function(){e.$util.back(),e.$util.getPage(-2).initRefresh(),e.$util.goUrl({url:1,openType:"navigateBack"})}),2e3),r.next=36;break;case 32:r.prev=32,r.t0=r["catch"](24),e.$util.hideAll(),e.lockTap=!1;case 36:case"end":return r.stop()}}),r,null,[[24,32]])})))()}})};r.default=o},6577:function(e,r,t){"use strict";t.r(r);var n=t("d51f"),i=t("7f6f");for(var a in i)["default"].indexOf(a)<0&&function(e){t.d(r,e,(function(){return i[e]}))}(a);t("005c");var c=t("828b"),s=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"3809edcc",null,!1,n["a"],void 0);r["default"]=s.exports},"7f6f":function(e,r,t){"use strict";t.r(r);var n=t("4afa"),i=t.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){t.d(r,e,(function(){return n[e]}))}(a);r["default"]=i.a},b684:function(e,r,t){var n=t("18c0");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=t("967d").default;i("7c108a16",n,!0,{sourceMap:!1,shadowMode:!1})},d51f:function(e,r,t){"use strict";t.d(r,"b",(function(){return n})),t.d(r,"c",(function(){return i})),t.d(r,"a",(function(){}));var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return e.isLoad?t("v-uni-view",{staticClass:"user-order-refund",style:{background:e.pageColor,paddingTop:"1rpx"}},[1*e.refundForm.car_price>0||1*e.refundForm.empty_order_cash>0?t("v-uni-view",{staticClass:"pd-lg f-caption c-title"},[t("v-uni-view",{staticClass:"f-paragraph text-bold"},[e._v("车费退款注意事项：")]),t("v-uni-view",{staticClass:"mt-sm"},[e._v("选择「全选项目」后才可选择退"+e._s(1*e.refundForm.car_price>0&&1*e.refundForm.empty_order_cash>0?"车费、空单费":1*e.refundForm.car_price>0?"车费":"空单费")+"。"),t("span",{staticClass:"c-warning"},[e._v("若选择退相应费用且退款金额设置为0，操作确定按钮后此单将取消，无法再次操作退款")])])],1):e._e(),e._l(e.refundForm.order,(function(r,n){return[0==n?t("v-uni-view",{key:n+"_0",staticClass:"fill-base pd-lg mt-md ml-md mr-md radius-16"},[t("v-uni-view",{staticClass:"f-title c-title text-bold pb-lg"},[e._v("首单项目")]),e._l(r.order_goods,(function(i,a){return[t("v-uni-view",{key:n+"_0",staticClass:"item-child flex-warp",class:[{"mt-lg":0!=a},{"pb-lg b-1px-b":i.is_check&&a!=r.order_goods.length-1}]},[t("v-uni-view",{staticClass:"flex-y-center",staticStyle:{height:"147rpx"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(1,n,a)}}},[t("i",{staticClass:"iconfont mr-md",class:[{"icon-xuanze":!i.is_check},{"icon-xuanze-fill":i.is_check}],style:{color:i.is_check?e.primaryColor:"#CACACA"}})]),t("v-uni-view",{staticClass:"flex-1"},[t("v-uni-view",{staticClass:"flex-warp",on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(1,n,a)}}},[t("v-uni-view",{staticClass:"goods-img"},[t("v-uni-view",{staticClass:"h5-image goods-img",style:{backgroundImage:"url('"+i.goods_cover+"')"}})],1),t("v-uni-view",{staticClass:"flex-1 ml-md"},[t("v-uni-view",{staticClass:"flex-between"},[t("v-uni-view",{staticClass:"f-title c-title text-bold max-300 ellipsis"},[e._v(e._s(i.goods_name))]),t("v-uni-view",{staticClass:"f-desc",style:{color:2==r.pay_type?e.primaryColor:[3,4,5].includes(r.pay_type)?e.subColor:6==r.pay_type?"#11C95E":"#333"}},[e._v(e._s(e.statusType[r.pay_type]))])],1),t("v-uni-view",{staticClass:"f-caption c-caption mt-sm",staticStyle:{height:"30rpx"}},[1*i.material_price>0?t("span",{staticClass:"mr-md"},[e._v(e._s(e.$t("action.materialText"))+"：¥"+e._s(i.material_price))]):e._e(),1*i.refund_comm_price>0?t("span",[e._v("手续费：¥"+e._s(i.refund_comm_price))]):e._e()]),t("v-uni-view",{staticClass:"flex-between mt-md"},[t("v-uni-view",{staticClass:"f-desc c-warning text-bold"},[e._v("¥"+e._s(i.true_price))]),t("v-uni-view",{staticClass:"f-desc",staticStyle:{color:"#4D4D4D"}},[e._v("x"+e._s(i.can_refund_num))])],1)],1)],1),i.is_check?t("v-uni-view",{staticClass:"mt-sm"},[1*i.true_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("项目金额")]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入"+e.$t("action.materialText")},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_price")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_price,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_price",r)},expression:"refundForm.order[index].order_goods[aindex].refund_price"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),1*i.material_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v(e._s(e.$t("action.materialText")))]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入"+e.$t("action.materialText")},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_material_price")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_material_price,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_material_price",r)},expression:"refundForm.order[index].order_goods[aindex].refund_material_price"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),1*i.refund_comm_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("手续费")]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入手续费"},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_comm_cash")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_comm_cash,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_comm_cash",r)},expression:"refundForm.order[index].order_goods[aindex].refund_comm_cash"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("退款数量")]),t("v-uni-view",{staticClass:"flex-warp"},[t("v-uni-button",{staticClass:"reduce",style:{borderColor:e.primaryColor,color:e.primaryColor},on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.changeNum(n,a,-1)}}},[t("i",{staticClass:"iconfont icon-jian-bold"})]),t("v-uni-button",{staticClass:"addreduce clear-btn"},[e._v(e._s(i.refund_num))]),t("v-uni-button",{staticClass:"add",style:{background:e.primaryColor,borderColor:e.primaryColor},on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.changeNum(n,a,1)}}},[t("i",{staticClass:"iconfont icon-jia-bold"})])],1)],1),t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("累计退款金额")]),t("v-uni-view",{staticClass:"c-title text-bold"},[e._v("¥"+e._s(i.total_refund_price))])],1)],1):e._e()],1)],1)]})),t("v-uni-view",{staticClass:"flex-between f-paragraph pt-lg mt-lg b-1px-t"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("服务时间")]),t("v-uni-view",{staticClass:"c-title"},[e._v(e._s(r.time_text))])],1)],2):e._e()]})),e.refundForm.order.length>1?t("v-uni-view",{staticClass:"fill-base pd-lg mt-md ml-md mr-md radius-16"},[e._l(e.refundForm.order,(function(r,n){return[0!=n?[1==n?t("v-uni-view",{staticClass:"f-title c-title text-bold"},[e._v("加钟项目")]):e._e(),e._l(r.order_goods,(function(i,a){return[t("v-uni-view",{key:n+"_0",staticClass:"item-child flex-warp mt-lg",class:[{"pb-lg b-1px-b":i.is_check&&a!=r.order_goods.length-1}]},[t("v-uni-view",{staticClass:"flex-y-center",staticStyle:{height:"147rpx"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(1,n,a)}}},[t("i",{staticClass:"iconfont mr-md",class:[{"icon-xuanze":!i.is_check},{"icon-xuanze-fill":i.is_check}],style:{color:i.is_check?e.primaryColor:"#CACACA"}})]),t("v-uni-view",{staticClass:"flex-1"},[t("v-uni-view",{staticClass:"flex-warp",on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(1,n,a)}}},[t("v-uni-view",{staticClass:"goods-img"},[t("v-uni-view",{staticClass:"h5-image goods-img",style:{backgroundImage:"url('"+i.goods_cover+"')"}})],1),t("v-uni-view",{staticClass:"flex-1 ml-md"},[t("v-uni-view",{staticClass:"flex-between"},[t("v-uni-view",{staticClass:"f-title c-title text-bold max-300 ellipsis"},[e._v(e._s(i.goods_name))]),t("v-uni-view",{staticClass:"f-desc",style:{color:2==r.pay_type?e.primaryColor:[3,4,5].includes(r.pay_type)?e.subColor:6==r.pay_type?"#11C95E":"#333"}},[e._v(e._s(e.statusType[r.pay_type]))])],1),t("v-uni-view",{staticClass:"f-caption c-caption mt-sm",staticStyle:{height:"30rpx"}},[1*i.material_price>0?t("span",{staticClass:"mr-md"},[e._v(e._s(e.$t("action.materialText"))+"：¥"+e._s(i.material_price))]):e._e(),1*i.refund_comm_price>0?t("span",[e._v("手续费：¥"+e._s(i.refund_comm_price))]):e._e()]),t("v-uni-view",{staticClass:"flex-between mt-md"},[t("v-uni-view",{staticClass:"f-desc c-warning text-bold"},[e._v("¥"+e._s(i.true_price))]),t("v-uni-view",{staticClass:"f-desc",staticStyle:{color:"#4D4D4D"}},[e._v("x"+e._s(i.can_refund_num))])],1)],1)],1),i.is_check?t("v-uni-view",{staticClass:"mt-sm"},[1*i.true_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("项目金额")]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入"+e.$t("action.materialText")},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_price")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_price,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_price",r)},expression:"refundForm.order[index].order_goods[aindex].refund_price"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),1*i.material_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v(e._s(e.$t("action.materialText")))]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入"+e.$t("action.materialText")},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_material_price")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_material_price,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_material_price",r)},expression:"refundForm.order[index].order_goods[aindex].refund_material_price"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),1*i.refund_comm_price>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("手续费")]),t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入手续费"},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,n,a,"refund_comm_cash")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(0,n,a)}},model:{value:e.refundForm.order[n].order_goods[a].refund_comm_cash,callback:function(r){e.$set(e.refundForm.order[n].order_goods[a],"refund_comm_cash",r)},expression:"refundForm.order[index].order_goods[aindex].refund_comm_cash"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1)],1):e._e(),t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("退款数量")]),t("v-uni-view",{staticClass:"flex-warp"},[t("v-uni-button",{staticClass:"reduce",style:{borderColor:e.primaryColor,color:e.primaryColor},on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.changeNum(n,a,-1)}}},[t("i",{staticClass:"iconfont icon-jian-bold"})]),t("v-uni-button",{staticClass:"addreduce clear-btn"},[e._v(e._s(i.refund_num))]),t("v-uni-button",{staticClass:"add",style:{background:e.primaryColor,borderColor:e.primaryColor},on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.changeNum(n,a,1)}}},[t("i",{staticClass:"iconfont icon-jia-bold"})])],1)],1),t("v-uni-view",{staticClass:"flex-between f-paragraph mt-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("累计退款金额")]),t("v-uni-view",{staticClass:"c-title text-bold"},[e._v("¥"+e._s(i.total_refund_price))])],1)],1):e._e()],1)],1)]})),t("v-uni-view",{staticClass:"flex-between f-paragraph pt-lg mt-lg b-1px-t"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("服务时间")]),t("v-uni-view",{staticClass:"c-title"},[e._v(e._s(r.time_text))])],1)]:e._e()]}))],2):e._e(),t("v-uni-view",{staticClass:"fill-base pd-lg mt-md ml-md mr-md radius-16"},[1*e.refundForm.car_price>0?[e.refundForm.can_refund_num!==e.refundForm.all_refund_num?t("v-uni-view",{staticClass:"flex-between f-paragraph mb-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("车费")]),t("v-uni-view",{staticClass:"c-title"},[e._v("¥"+e._s(e.refundForm.car_price))])],1):e._e(),e.refundForm.can_refund_num===e.refundForm.all_refund_num?t("v-uni-view",{staticClass:"flex-between f-paragraph mb-md"},[t("v-uni-view",{staticClass:"flex-center",staticStyle:{height:"38rpx"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(4)}}},[t("i",{staticClass:"iconfont mr-sm",class:[{"icon-xuanze":!e.refundForm.is_car_check},{"icon-xuanze-fill":e.refundForm.is_car_check}],style:{color:e.refundForm.is_car_check?e.primaryColor:"#CACACA"}}),t("v-uni-view",{staticClass:"c-paragraph"},[e._v("车费"+e._s(e.refundForm.is_car_check?"退款金额":""))])],1),e.refundForm.is_car_check?t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入车费"},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,-1,-1,"refund_car_price")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(3)}},model:{value:e.refundForm.refund_car_price,callback:function(r){e.$set(e.refundForm,"refund_car_price",r)},expression:"refundForm.refund_car_price"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1):t("v-uni-view",{staticClass:"c-title"},[e._v("¥"+e._s(e.refundForm.car_price))])],1):e._e()]:e._e(),e.refundForm.can_refund_num===e.refundForm.all_refund_num&&1*e.refundForm.empty_order_cash>0?[t("v-uni-view",{staticClass:"flex-between f-paragraph mb-md"},[t("v-uni-view",{staticClass:"flex-center",staticStyle:{height:"38rpx"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(6)}}},[t("i",{staticClass:"iconfont mr-sm",class:[{"icon-xuanze":!e.refundForm.is_empty_check},{"icon-xuanze-fill":e.refundForm.is_empty_check}],style:{color:e.refundForm.is_empty_check?e.primaryColor:"#CACACA"}}),t("v-uni-view",{staticClass:"c-paragraph"},[e._v("空单费"+e._s(e.refundForm.is_empty_check?"退款金额":""))])],1),e.refundForm.is_empty_check?t("v-uni-view",{staticClass:"flex-y-center c-title"},[t("v-uni-input",{staticClass:"text-right",attrs:{type:"number",placeholder:"请输入空单费"},on:{input:function(r){arguments[0]=r=e.$handleEvent(r),e.checkInput(r,-1,-1,"refund_empty_cash")},blur:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(5)}},model:{value:e.refundForm.refund_empty_cash,callback:function(r){e.$set(e.refundForm,"refund_empty_cash",r)},expression:"refundForm.refund_empty_cash"}}),t("v-uni-view",{staticClass:"ml-sm"},[e._v("元")])],1):t("v-uni-view",{staticClass:"c-title"},[e._v("-¥"+e._s(e.refundForm.empty_order_cash))])],1)]:e._e(),1*e.refundForm.discount>0?t("v-uni-view",{staticClass:"flex-between f-paragraph mb-md"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("卡券抵扣")]),t("v-uni-view",{staticClass:"c-title"},[e._v("¥"+e._s(e.refundForm.discount))])],1):e._e(),t("v-uni-view",{staticClass:"flex-between f-paragraph"},[t("v-uni-view",{staticClass:"c-paragraph"},[e._v("总计退款金额")]),t("v-uni-view",{staticClass:"c-warning text-bold"},[e._v("¥"+e._s(e.refundForm.total_refund_price))])],1)],2),t("v-uni-view",{staticClass:"pd-md f-caption c-warning"},[e._v("总计退款金额 = A项目(项目费+"+e._s(e.$t("action.materialText"))+e._s(e.refundForm.after_service_can_refund&&e.refundForm.order[0].pay_type>5?"-手续费":"")+") * 退款数量 + B项目(项目费+"+e._s(e.$t("action.materialText"))+e._s(e.refundForm.after_service_can_refund&&e.refundForm.order[0].pay_type>5?"-手续费":"")+") * 退款数量 + ... + N项目(项目费+"+e._s(e.$t("action.materialText"))+e._s(e.refundForm.after_service_can_refund&&e.refundForm.order[0].pay_type>5?"-手续费":"")+") * 退款数量\n\t\t"+e._s(e.refundForm.car_price&&e.refundForm.is_car_check&&e.refundForm.can_refund_num===e.refundForm.all_refund_num?"+ 车费退款金额":"")+"\n\t\t"+e._s(e.refundForm.empty_order_cash&&e.refundForm.can_refund_num===e.refundForm.all_refund_num?e.refundForm.is_empty_check?"- 空单费 + 空单费退款金额":"- 空单费":""))]),t("v-uni-view",{staticClass:"space-max-footer"}),t("v-uni-view",{staticClass:"refund-bottom-info fill-base fix pl-lg pr-lg"},[t("v-uni-view",{staticClass:"flex-between"},[t("v-uni-view",[e.refundForm.can_refund_num>0?t("v-uni-view",{staticClass:"flex-y-center",on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.handleCheckOrderItem(2)}}},[t("i",{staticClass:"iconfont mr-md",class:[{"icon-xuanze":!e.refundForm.is_check},{"icon-xuanze-fill":e.refundForm.is_check}],style:{color:e.refundForm.is_check?e.primaryColor:"#CACACA"}}),e._v("全选项目")]):e._e()],1),t("v-uni-view",{staticClass:"flex-center"},[t("v-uni-button",{staticClass:"clear-btn order",on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.$util.goUrl({url:1,openType:"navigateBack"})}}},[e._v("取消")]),t("v-uni-button",{staticClass:"clear-btn order",style:{color:"#fff",background:e.primaryColor,borderColor:e.primaryColor},on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.toConfirmRefund.apply(void 0,arguments)}}},[e._v("确认")])],1)],1),t("v-uni-view",{staticClass:"space-safe"})],1)],2):e._e()},i=[]}}]);