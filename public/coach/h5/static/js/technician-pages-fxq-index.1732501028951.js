(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["technician-pages-fxq-index"],{"0cfe":function(e,t,n){"use strict";n("6a54");var i=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("bf0f"),n("2797"),n("fd3c");var a=i(n("2634")),o=i(n("2fdc")),c=i(n("9b1b")),s=i(n("7622")),r=n("8f59"),u={components:{parser:s.default},data:function(){return{timer:null,authTime:0,subForm:{phone:"",code:""},subRule:[{name:"phone",checkType:"isMobile",errorMsg:"请输入手机号",regText:"手机号"},{name:"code",checkType:"isNotNull",errorMsg:"请输入短信验证码"}],imageArr:[],typeList:[{title:"合同",id:0},{title:"承诺书",id:1}],activeIndex:0,isLoad:!1,isSuccess:!1,submitTap:!1,lockTap:!1,file_list:[]}},computed:(0,r.mapState)({coachInfo:function(e){return e.user.coachInfo},configInfo:function(e){return e.config.configInfo}}),onLoad:function(){this.$util.showLoading(),this.initIndex()},methods:(0,c.default)((0,c.default)({},(0,r.mapActions)(["getConfigInfo","getCoachInfo"])),{},{initIndex:function(){var e=arguments,t=this;return(0,o.default)((0,a.default)().mark((function n(){var i,o,c,s,r;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],t.configInfo.id&&!i){n.next=4;break}return n.next=4,t.getConfigInfo();case 4:if(t.$util.setNavigationBarColor({bg:t.primaryColor}),o="",c=t.coachInfo.is_fxq,s=void 0===c?0:c,s){n.next=13;break}return n.next=10,t.$api.technician.addContract();case 10:o=n.sent,n.next=16;break;case 13:return n.next=15,t.getCoachInfo();case 15:o=t.coachInfo.fxq_info;case 16:r=[],o&&(o.file_list.forEach((function(e){e.company_view_contract_img=e.company_view_contract_img?JSON.parse(e.company_view_contract_img):[],e.coach_view_contract_img=e.coach_view_contract_img?JSON.parse(e.coach_view_contract_img):[],r[e.type-1]={image:e.company_view_contract_img,contract_image:e.coach_view_contract_img}})),t.imageArr=r,t.file_list=o.file_list),i||t.$jweixin.hideOptionMenu(),t.isLoad=!0,t.$util.hideAll();case 21:case"end":return n.stop()}}),n)})))()},onMessage:function(e){console.log(e,"========> onMessage")},toConfirm:function(){this.$refs.show_phone_item.open()},changeNav:function(e){this.activeIndex=e},validate:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new this.$util.Validate;this.subRule.map((function(i){var a=i.name;"code"==a&&t||n.add(e[a],i)}));var i=n.start();return i},toSend:function(){var e=this;return(0,o.default)((0,a.default)().mark((function t(){var n,i,o,c,s;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.authTime,!n){t.next=3;break}return t.abrupt("return");case 3:if(i=e.subForm.phone,o=void 0===i?"":i,c=e.validate({phone:o},!0),!c){t.next=8;break}return e.$util.showToast({title:c}),t.abrupt("return");case 8:if(!e.lockTap){t.next=10;break}return t.abrupt("return");case 10:return e.lockTap=!0,e.$util.showLoading(),t.prev=12,t.next=15,e.$api.technician.sendFxqCode({phone:o});case 15:e.$util.hideAll(),e.lockTap=!1,e.subForm.code="",s=60,e.timer=setInterval((function(){0!==s?(s--,e.authTime=s):clearInterval(e.timer)}),1e3),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](12),setTimeout((function(){e.lockTap=!1,e.$util.hideAll()}),2e3);case 25:case"end":return t.stop()}}),t,null,[[12,22]])})))()},submit:function(){var e=this;return(0,o.default)((0,a.default)().mark((function t(){var n,i;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$util.deepCopy(e.subForm),i=e.validate(n),!i){t.next=5;break}return e.$util.showToast({title:i}),t.abrupt("return");case 5:if(6==n.code.length){t.next=8;break}return e.$util.showToast({title:"请输入6位数短信验证码"}),t.abrupt("return");case 8:if(!e.submitTap){t.next=10;break}return t.abrupt("return");case 10:return e.submitTap=!0,t.prev=11,e.$util.showLoading(),t.next=15,e.$api.technician.fxqSign(n);case 15:e.$util.hideAll(),e.$util.showToast({title:"签署成功"}),e.isSuccess=!0,e.submitTap=!1,e.$refs.show_phone_item.close(),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](11),setTimeout((function(){e.$util.hideAll(),e.submitTap=!1}),2e3);case 25:case"end":return t.stop()}}),t,null,[[11,22]])})))()}})};t.default=u},"17b4":function(e,t,n){"use strict";var i=n("4eb6"),a=n.n(i);a.a},"44f8":function(e,t,n){"use strict";n.r(t);var i=n("0cfe"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=a.a},"4eb6":function(e,t,n){var i=n("c0e4f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("967d").default;a("92b4e30c",i,!0,{sourceMap:!1,shadowMode:!1})},a930:function(e,t,n){"use strict";n.r(t);var i=n("d2a2"),a=n("44f8");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("17b4");var c=n("828b"),s=Object(c["a"])(a["default"],i["b"],i["c"],!1,null,"315b1554",null,!1,i["a"],void 0);t["default"]=s.exports},c0e4f:function(e,t,n){var i=n("c86c");t=i(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.fxq-pages .nav-item[data-v-315b1554]{height:%?88?%}.fxq-pages .content uni-image[data-v-315b1554]{width:100%}.fxq-pages .popup-phone[data-v-315b1554]{width:%?630?%}.fxq-pages .popup-phone .input-info[data-v-315b1554]{width:%?570?%;height:%?90?%;background:#f7f7f7}.fxq-pages .popup-phone .input-info .item-input[data-v-315b1554]{height:%?90?%;font-size:%?32?%;text-align:left}.fxq-pages .popup-phone .input-info.sm[data-v-315b1554]{width:%?400?%}.fxq-pages .popup-phone .send-btn[data-v-315b1554]{width:%?150?%;height:%?90?%}.fxq-pages .icon-box[data-v-315b1554]{padding-top:%?127?%}.fxq-pages .success-btn-box[data-v-315b1554]{padding-top:%?90?%}.fxq-pages .success-btn-box .success-btn[data-v-315b1554]{width:%?285?%;height:%?92?%;border-radius:%?92?%}',""]),e.exports=t},d2a2:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isLoad?n("v-uni-view",{staticClass:"fxq-pages"},[e.isSuccess?[n("v-uni-view",{staticClass:"flex-center icon-box"},[n("v-uni-image",{staticClass:"suc-img",attrs:{src:"https://lbqny.migugu.com/admin/public/apply_suc.png",mode:"aspectFill"}})],1),n("v-uni-view",{staticClass:"flex-center f-paragraph"},[e._v("签署成功")]),n("v-uni-view",{staticClass:"flex-center success-btn-box"},[n("v-uni-view",{staticClass:"success-btn flex-center f-mini-title",style:{border:"1px solid "+e.primaryColor,color:e.primaryColor},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$util.goUrl({url:"/technician/pages/mine",openType:"redirectTo"})}}},[e._v("返回个人中心")])],1)]:[e.file_list[1]?n("fixed",[n("v-uni-view",{staticClass:"nav-list flex-center fill-base b-1px-b"},e._l(e.typeList,(function(t,i){return n("v-uni-view",{key:i,staticClass:"nav-item flex-center flex-1 f-mini-title ",class:[{"text-bold":t.id==e.activeIndex}],style:{color:t.id==e.activeIndex?e.primaryColor:"#333"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.changeNav(t.id)}}},[e._v(e._s(t.title))])})),1)],1):e._e(),n("v-uni-view",{staticClass:"content"},[e._l(0==e.coachInfo.is_fxq?e.imageArr[e.activeIndex].image:e.imageArr[e.activeIndex].contract_image,(function(t,i){return[n("v-uni-image",{key:i+"_0",attrs:{src:t,mode:"widthFix"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.$util.previewImage({current:t,urls:0==e.coachInfo.is_fxq?e.imageArr[e.activeIndex].image:e.imageArr[e.activeIndex].contract_image})}}})]}))],2),n("v-uni-view",{class:[{"space-max-footer":0==e.coachInfo.is_fxq},{"space-footer":1==e.coachInfo.is_fxq}]}),0==e.coachInfo.is_fxq?n("fix-bottom-button",{attrs:{text:[{type:"confirm",text:"合同签署"}],bgColor:"#fff"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.toConfirm.apply(void 0,arguments)}}}):e._e()],n("uni-popup",{ref:"show_phone_item",attrs:{maskClick:!0,zIndex:999}},[n("v-uni-view",{staticClass:"common-popup-content popup-phone pd-lg flex-center flex-column fill-base"},[n("v-uni-view",{staticClass:"f-md-title c-black"},[e._v("意愿认证")]),n("v-uni-view",{staticClass:"space-lg pb-lg"}),n("v-uni-view",{staticClass:"space-lg pb-lg"}),n("v-uni-view",{staticClass:"flex-center mb-lg"},[n("v-uni-view",{staticClass:"input-info sm mr-md radius-16"},[n("v-uni-input",{staticClass:"item-input flex-y-center pl-lg pr-lg f-sm-title c-title",attrs:{type:"number","placeholder-class":"c-placeholder",placeholder:e.subRule[0].errorMsg},model:{value:e.subForm.phone,callback:function(t){e.$set(e.subForm,"phone",t)},expression:"subForm.phone"}})],1),n("v-uni-view",{staticClass:"send-btn flex-center c-base radius-16",style:{background:e.primaryColor},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toSend.apply(void 0,arguments)}}},[e._v(e._s(e.authTime>0?"("+e.authTime+"s)":"发送"))])],1),n("v-uni-view",{staticClass:"input-info radius-16"},[n("v-uni-input",{staticClass:"item-input flex-y-center pl-lg pr-lg f-sm-title c-title",attrs:{type:"number",maxlength:"6","placeholder-class":"c-placeholder",placeholder:e.subRule[1].errorMsg},model:{value:e.subForm.code,callback:function(t){e.$set(e.subForm,"code",t)},expression:"subForm.code"}})],1),n("v-uni-view",{staticClass:"button"},[n("v-uni-view",{staticClass:"item-child",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.$refs.show_phone_item.close()}}},[e._v("取消")]),n("v-uni-view",{staticClass:"item-child",style:{background:e.primaryColor,color:"#fff"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("确定")])],1)],1)],1)],2):e._e()},a=[]}}]);