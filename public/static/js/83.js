webpackJsonp([83],{"8rML":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("3cXf"),i=a.n(r),n=a("rVsN"),s=a.n(n),o=a("KH7x"),l=a.n(o),c=a("lC5x"),u=a.n(c),m=a("J0Oq"),d=a.n(m),p=a("PxTW"),h=a.n(p),_={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>1e3*(h()(h()(Date.now()).format("YYYY-MM-DD")).unix()+86400-1)}},reseller_cash_type:"",loading:{list:!1,distribution:!1,user:!1},searchForm:{list:{page:1,limit:10,start_time:"",end_time:"",name:"",count_start_time:"",count_end_time:""},distribution:{page:1,limit:10,name:""},user:{page:1,limit:10,name:""}},tableData:{list:[],distribution:[],user:[]},total:{list:0,distribution:0,user:0},showDialog:{distribution:!1,user:!1}}},activated:function(){var t=this;return d()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.getBaseInfo(),t.getTableDataList(1,"list");case 2:case"end":return e.stop()}},e,t)}))()},methods:{getBaseInfo:function(){var t=this;return d()(u.a.mark(function e(){var a,r,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.all([t.$api.system.configInfo()]);case 2:a=e.sent,r=l()(a,1),i=r[0],t.reseller_cash_type=i.data.reseller_cash_type;case 6:case"end":return e.stop()}},e,t)}))()},resetForm:function(t){var e=t+"Form";this.$refs[e].resetFields(),this.getTableDataList(1,t)},handleSizeChange:function(t,e){this.searchForm[e].limit=t,this.handleCurrentChange(1,e)},handleCurrentChange:function(t,e){this.searchForm[e].page=t,this.getTableDataList("",e)},toChange:function(t){var e=this;return d()(u.a.mark(function a(){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.searchForm.list.status=t,e.getTableDataList(1,"list");case 2:case"end":return a.stop()}},a,e)}))()},getTableDataList:function(t,e){var a=this;return d()(u.a.mark(function r(){var n,s,o,l,c,m,d,p,h;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t&&(a.searchForm[e].page=t),a.loading[e]=!0,n=JSON.parse(i()(a.searchForm[e])),"list"===e&&(s=n.start_time,o=n.count_start_time,s&&s.length>1?(n.start_time=s[0]/1e3,n.end_time=s[1]/1e3):(n.start_time="",n.end_time=""),o&&o.length>1?(n.count_start_time=o[0]/1e3,n.count_end_time=o[1]/1e3):(n.count_start_time="",n.count_end_time="")),l={list:{methodKey:"distribution",methodModel:"partnerDataList"},distribution:{methodKey:"distribution",methodModel:"subReseller"},user:{methodKey:"distribution",methodModel:"subUser"}}[e],c=l.methodKey,m=l.methodModel,r.next=8,a.$api[c][m](n);case 8:if(d=r.sent,p=d.code,h=d.data,a.loading[e]=!1,200===p){r.next=14;break}return r.abrupt("return");case 14:a.tableData[e]=h.data,a.total[e]=h.total;case 16:case"end":return r.stop()}},r,a)}))()},toShowDialog:function(t,e){var a=this;return d()(u.a.mark(function r(){var i;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!["distribution","user"].includes(t)){r.next=6;break}return i="distribution"===t?"id":"user_id",a.searchForm[t][i]=e,a.searchForm[t].name="",r.next=6,a.getTableDataList(1,t);case 6:a.showDialog[t]=!a.showDialog[t];case 7:case"end":return r.stop()}},r,a)}))()},confirmDel:function(t){var e=this;this.$confirm("你确认要解除绑定吗？",this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){e.updateItem(t,"user")}).catch(function(){})},updateItem:function(t,e){var a=this;return d()(u.a.mark(function r(){return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a.$api.distribution.delSubUser({user_id:t}).then(function(t){200===t.code&&(a.$message.success(a.$t("tips.successOper")),a.searchForm[e].page=a.searchForm[e].page<Math.ceil((a.total[e]-1)/a.searchForm[e].limit)?a.searchForm[e].page:Math.ceil((a.total[e]-1)/a.searchForm[e].limit),a.getTableDataList("",e),a.getTableDataList("","list"))});case 1:case"end":return r.stop()}},r,a)}))()}},filters:{handleTime:function(t,e){return 1===e?h()(1e3*t).format("YYYY-MM-DD"):2===e?h()(1e3*t).format("HH:mm:ss"):h()(1e3*t).format("YYYY-MM-DD HH:mm:ss")}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-distribution-count"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-top-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-distributionFind",expression:"`${$route.name}-distributionFind`"}],attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.$router.push("/promotion/distribution/find")}}},[t._v(t._s(t.$t("menu.DistributionFind")))])],1),t._v(" "),a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"listForm",attrs:{inline:!0,model:t.searchForm.list},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入"+t.$t("action.resellerName")+"姓名/昵称/手机号"},model:{value:t.searchForm.list.name,callback:function(e){t.$set(t.searchForm.list,"name",e)},expression:"searchForm.list.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"入驻时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp","picker-options":t.pickerOptions,"default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.getTableDataList(1,"list")}},model:{value:t.searchForm.list.start_time,callback:function(e){t.$set(t.searchForm.list,"start_time",e)},expression:"searchForm.list.start_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"统计日期",prop:"count_start_time"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp","picker-options":t.pickerOptions,"default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.getTableDataList(1,"list")}},model:{value:t.searchForm.list.count_start_time,callback:function(e){t.$set(t.searchForm.list,"count_start_time",e)},expression:"searchForm.list.count_start_time"}})],1),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1,"list")}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("list")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.list,expression:"loading.list"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.list,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID"},scopedSlots:t._u([{key:"default",fn:function(e){return 1*e.row.id>0?[t._v("\n          "+t._s(e.row.id)+"\n        ")]:void 0}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"user_id",label:"用户ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"avatarUrl",label:"微信头像"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.avatarUrl}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"微信昵称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:t.$t("action.resellerName")+"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sh_time",label:"入驻时间","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!==e.row.sh_time?a("block",[a("p",[t._v(t._s(t._f("handleTime")(e.row.sh_time,1)))]),t._v(" "),a("p",[t._v(t._s(t._f("handleTime")(e.row.sh_time,2)))])]):a("block",[t._v("-")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"total_sub_count",label:"累计邀请下级"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total_user_count",label:"累计邀请用户"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total_order_count",label:"累计成交订单数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"order_comm_cash",label:"累计获得佣金"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s("¥"+e.row.order_comm_cash)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-inviteDistribution",expression:"`${$route.name}-inviteDistribution`"},{name:"show",rawName:"v-show",value:-1!==e.row.id,expression:"scope.row.id !== -1"}],attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.toShowDialog("distribution",e.row.id)}}},[t._v(t._s(t.$t("action.inviteDistribution")))]),t._v(" "),a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-inviteUser",expression:"`${$route.name}-inviteUser`"}],attrs:{size:"mini",plain:"",type:"success"},on:{click:function(a){return t.toShowDialog("user",e.row.user_id)}}},[t._v(t._s(t.$t("action.inviteUser")))])],1)]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.list.page,pageSize:t.searchForm.list.limit,total:t.total.list},on:{handleSizeChange:function(e){return t.handleSizeChange(e,"list")},handleCurrentChange:function(e){return t.handleCurrentChange(e,"list")}}}),t._v(" "),a("el-dialog",{attrs:{title:t.$t("action.inviteDistribution"),visible:t.showDialog.distribution,width:"1000px",top:"5vh",center:""},on:{"update:visible":function(e){return t.$set(t.showDialog,"distribution",e)}}},[a("el-form",{ref:"distributionForm",attrs:{inline:!0,model:t.searchForm.distribution,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入下级姓名"},model:{value:t.searchForm.distribution.name,callback:function(e){t.$set(t.searchForm.distribution,"name",e)},expression:"searchForm.distribution.name"}})],1),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1,"distribution")}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("distribution")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.distribution,expression:"loading.distribution"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData.distribution,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"avatarUrl",label:"微信头像"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.avatarUrl}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"下级姓名"}}),t._v(" "),t.reseller_cash_type?t._e():a("el-table-column",{attrs:{prop:"balance",label:"下级提成","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.balance)+"%")])]}}],null,!1,2037388633)},[a("template",{slot:"header"},[a("div",{staticStyle:{"margin-top":"7px",padding:"0"}},[t._v("\n              下级提成\n              "),a("lb-tool-tips",{attrs:{padding:"10"}},[t._v(t._s(t.$t("action.resellerName"))+"邀请用户下单时的提成比例")])],1)])],2),t._v(" "),a("el-table-column",{attrs:{prop:"total_sub_count",label:"累计邀请下级"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total_user_count",label:"累计邀请用户"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total_order_count",label:"累计成交订单数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"order_comm_cash",label:"累计获得佣金"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s("¥"+e.row.order_comm_cash)+"\n          ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sh_time",label:"加入时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("handleTime")(e.row.sh_time,1)))]),t._v(" "),a("p",[t._v(t._s(t._f("handleTime")(e.row.sh_time,2)))])]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.distribution.page,pageSize:t.searchForm.distribution.limit,total:t.total.distribution},on:{handleSizeChange:function(e){return t.handleSizeChange(e,"distribution")},handleCurrentChange:function(e){return t.handleCurrentChange(e,"distribution")}}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.$t("action.inviteUser"),visible:t.showDialog.user,width:"1000px",top:"5vh",center:""},on:{"update:visible":function(e){return t.$set(t.showDialog,"user",e)}}},[a("el-form",{ref:"userForm",attrs:{inline:!0,model:t.searchForm.user,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户昵称"},model:{value:t.searchForm.user.name,callback:function(e){t.$set(t.searchForm.user,"name",e)},expression:"searchForm.user.name"}})],1),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1,"user")}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("user")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.user,expression:"loading.user"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData.user,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"id",label:"用户ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"avatarUrl",label:"微信头像"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.avatarUrl}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"微信昵称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"绑定时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(t._f("handleTime")(e.row.create_time,1)))]),t._v(" "),a("div",[t._v(t._s(t._f("handleTime")(e.row.create_time,2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-cancelBindUser",expression:"`${$route.name}-cancelBindUser`"}],attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return t.confirmDel(e.row.id)}}},[t._v(t._s(t.$t("action.cancelBindUser")))])],1)]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.user.page,pageSize:t.searchForm.user.limit,total:t.total.user},on:{handleSizeChange:function(e){return t.handleSizeChange(e,"user")},handleCurrentChange:function(e){return t.handleCurrentChange(e,"user")}}})],1)],1)],1)},staticRenderFns:[]};var f=a("C7Lr")(_,b,!1,function(t){a("SncM")},"data-v-755a5b2a",null);e.default=f.exports},SncM:function(t,e){}});