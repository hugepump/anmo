webpackJsonp([42],{RLMa:function(t,e){},zaVW:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("3cXf"),i=a.n(l),r=a("lC5x"),s=a.n(r),n=a("J0Oq"),o=a.n(n),d=a("4YfN"),c=a.n(d),u=a("PxTW"),p=a.n(u),m=a("bSIt"),h={data:function(){return{loading:{list:!1},base_agent:[],searchForm:{list:{page:1,limit:10,title:"",admin_id:"",top_type:0,sort:0}},tableData:{list:[]},total:{list:0}}},activated:function(){this.getBaseInfo(),this.getTableDataList(1,"list")},computed:c()({},Object(m.e)({routesItem:function(t){return t.routes}})),methods:{getBaseInfo:function(){var t=this;return o()(s.a.mark(function e(){var a,l,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.routesItem.userInfo.is_admin){e.next=10;break}return e.next=3,t.$api.agent.adminSelect();case 3:if(a=e.sent,l=a.code,i=a.data,200===l){e.next=8;break}return e.abrupt("return");case 8:i.unshift({id:-1,agent_name:"平台"}),t.base_agent=i;case 10:case"end":return e.stop()}},e,t)}))()},resetForm:function(t){var e=t+"Form",a=this.searchForm.list.top_type,l=void 0===a?0:a;delete this.searchForm.list.top_type,delete this.searchForm.list.sort,this.$refs[e].resetFields(),l&&(this.$refs["dateSort_"+l].columnConfig.order=""),this.getTableDataList(1,t)},handleSizeChange:function(t,e){this.searchForm[e].limit=t,this.handleCurrentChange(1,e)},handleCurrentChange:function(t,e){this.searchForm[e].page=t,this.getTableDataList("",e)},sortChange:function(t){var e=t.order,a=t.prop;null===e?(delete this.searchForm.list.top_type,delete this.searchForm.list.sort):(this.searchForm.list.top_type={total_num:1,get_num:2,use_num:3,discount_price:4,total_price:5,total_balance:6,order_count:7,old_user_num:8,new_user_num:9}[a],this.searchForm.list.sort="ascending"===e?2:1),this.getTableDataList(1,"list")},getTableDataList:function(t,e){var a=this;return o()(s.a.mark(function l(){var r,n,o,d,c,u,p;return s.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t&&(a.searchForm[e].page=t),a.tableData[e]=[],a.loading[e]=!0,r=JSON.parse(i()(a.searchForm[e])),"list"===e&&(r.admin_id||delete r.admin_id,-1===r.admin_id&&(r.admin_id=0)),n={list:{methodKey:"market",methodModel:"couponData"}}[e],o=n.methodKey,d=n.methodModel,l.next=9,a.$api[o][d](r);case 9:if(c=l.sent,u=c.code,p=c.data,a.loading[e]=!1,200===u){l.next=15;break}return l.abrupt("return");case 15:a.tableData[e]=p.data,a.total[e]=p.total;case 17:case"end":return l.stop()}},l,a)}))()}},filters:{handleTime:function(t,e){return 1===e?p()(1e3*t).format("YYYY-MM-DD"):2===e?p()(1e3*t).format("HH:mm:ss"):p()(1e3*t).format("YYYY-MM-DD HH:mm:ss")}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-market-coupon-list"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"listForm",attrs:{inline:!0,model:t.searchForm.list},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入卡券名称"},model:{value:t.searchForm.list.title,callback:function(e){t.$set(t.searchForm.list,"title",e)},expression:"searchForm.list.title"}})],1),t._v(" "),t.routesItem.userInfo.is_admin?a("el-form-item",{attrs:{label:"创建人",prop:"admin_id"}},[a("el-select",{attrs:{placeholder:"请选择创建人",filterable:"",clearable:""},on:{change:function(e){return t.getTableDataList(1,"list")}},model:{value:t.searchForm.list.admin_id,callback:function(e){t.$set(t.searchForm.list,"admin_id",e)},expression:"searchForm.list.admin_id"}},t._l(t.base_agent,function(t){return a("el-option",{key:t.id,attrs:{label:t.agent_name,value:t.id}})}),1)],1):t._e(),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1,"list")}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("list")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.list,expression:"loading.list"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.list,"header-cell-style":{background:"#f5f7fa",color:"#606266"}},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{prop:"id",label:"卡券ID",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"卡券名称","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[-1===e.row.status?a("span",{staticClass:"c-warning mr-sm"},[t._v("[已删除]")]):t._e(),t._v(t._s(e.row.title)+"\n        ")]}}])}),t._v(" "),t.routesItem.userInfo.is_admin?a("el-table-column",{attrs:{prop:"create_user",label:"创建人","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.admin_id?""+e.row.admin_city+t.$t("action.agentName")+"-"+e.row.agent_name:e.row.agent_name)+"\n        ")]}}],null,!1,2845143298)}):t._e(),t._v(" "),a("el-table-column",{ref:"dateSort_1",attrs:{prop:"total_num",label:"券总数",sortable:"custom",width:"100"}}),t._v(" "),a("el-table-column",{ref:"dateSort_2",attrs:{prop:"get_num",label:"已领取总数",sortable:"custom",width:"150"}},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            已领取总数"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("已被领取的卡券数量")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_3",attrs:{prop:"use_num",label:"已使用总数",sortable:"custom",width:"150"}},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            已使用总数"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("领取后被使用的卡券数量")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_4",attrs:{prop:"discount_price",label:"优惠总金额",sortable:"custom",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          ¥"+t._s(e.row.discount_price)+"\n        ")]}}])},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            优惠总金额"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("所有已被使用的卡券金额总和，下单就统计")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_5",attrs:{prop:"total_price",label:"订单总金额",sortable:"custom",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.total_price)+" ")]}}])},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            订单总金额"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("使用卡券优惠后，获得的订单总金额数，不包含车费")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_6",attrs:{prop:"total_balance",label:"费效比",sortable:"custom",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.total_balance)+"%\n        ")]}}])},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            费效比"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("费效比就是指发放出去的卡券（即营销成本）带回来的订单业绩有多少\n              "),a("div",{staticClass:"mt-sm"},[t._v("\n                费效比 =（卡券优惠总金额 / 订单总金额 ）* 100%\n              ")])])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_7",attrs:{prop:"order_count",label:"成交订单",sortable:"custom",width:"140"}},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            成交订单"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("使用该卡券获得的订单总量\n            ")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_8",attrs:{prop:"old_user_num",label:"促活老用户",sortable:"custom",width:"150"}},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            促活老用户"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("卡券派发前注册系统的用户为老用户\n            ")])],1)])],2),t._v(" "),a("el-table-column",{ref:"dateSort_9",attrs:{prop:"new_user_num",label:"成交新用户",sortable:"custom",width:"150"}},[a("template",{slot:"header"},[a("div",{staticClass:"rel flex-y-baseline",staticStyle:{top:"7px",padding:"0",height:"19px","line-height":"1"}},[t._v("\n            成交新用户"),a("lb-tool-tips",{attrs:{padding:"0"}},[t._v("卡券派发当日注册平台的用户为新用户\n            ")])],1)])],2)],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.list.page,pageSize:t.searchForm.list.limit,total:t.total.list},on:{handleSizeChange:function(e){return t.handleSizeChange(e,"list")},handleCurrentChange:function(e){return t.handleCurrentChange(e,"list")}}})],1)],1)},staticRenderFns:[]};var f=a("C7Lr")(h,_,!1,function(t){a("RLMa")},"data-v-d353703a",null);e.default=f.exports}});