webpackJsonp([184],{"11Lc":function(r,e){},EyI9:function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("3cXf"),n=t.n(o),a=t("lC5x"),i=t.n(a),l=t("J0Oq"),u=t.n(l),s={data:function(){var r=this,e=function(r,e,t){for(var o in e){var n=1*o+1;if(!e[o].phone)return void t(new Error("第"+n+"条数据：请输入管理员手机号"))}e.filter(function(r){return r.phone}).length===e.length&&t()};return{subForm:{virtual_status:0,virtual_type:1,moor_virtual_type:1,pool_key:"",moor_phone_arr:[],winnerlook_phone_arr:[]},subFormRules:{virtual_status:{required:!0,type:"number",message:"请选择是否开启虚拟号码",trigger:"blur"},virtual_type:{required:!0,type:"number",message:"请选择虚拟号码运营商",trigger:"blur"},moor_virtual_type:{required:!0,validator:function(e,t,o){2!==r.subForm.virtual_type||t?o():o(new Error("请选择虚拟号模式"))},trigger:"blur"},pool_key:{required:!0,validator:function(e,t,o){1!==r.subForm.virtual_status||t?o():o(new Error("请输入号码池"))},trigger:"blur"},moor_phone_arr:{required:!0,validator:e,trigger:"blur"},winnerlook_phone_arr:{required:!0,validator:e,trigger:"blur"}}}},created:function(){var r=this;return u()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDetail();case 2:case"end":return e.stop()}},e,r)}))()},methods:{getDetail:function(){var r=this;return u()(i.a.mark(function e(){var t,o,n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$api.system.virtualConfigInfo();case 2:if(t=e.sent,o=t.code,n=t.data,200===o){e.next=7;break}return e.abrupt("return");case 7:for(a in["moor_phone_arr","winnerlook_phone_arr"].map(function(r){n[r]=n[r]&&n[r].length>0?n[r].map(function(r){return{phone:r}}):[{phone:""}]}),r.subForm)r.subForm[a]=n[a];case 10:case"end":return e.stop()}},e,r)}))()},toAddItem:function(r,e,t){var o=this;return u()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:2===e?o.subForm[r].splice(t,1):o.subForm[r].push({phone:""});case 1:case"end":return n.stop()}},n,o)}))()},submitFormInfo:function(r){var e=this;return u()(i.a.mark(function t(){var o,a,l,u,s,p,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=!0,e.$refs[r].validate(function(r){r||(o=!1)}),o){t.next=4;break}return t.abrupt("return");case 4:return a=JSON.parse(n()(e.subForm)),l=a.moor_phone_arr,u=a.winnerlook_phone_arr,s=l.filter(function(r){return r.phone}),a.moor_phone_arr=s.map(function(r){return r.phone}),p=u.filter(function(r){return r.phone}),a.winnerlook_phone_arr=p.map(function(r){return r.phone}),t.next=12,e.$api.system.virtualConfigUpdate(a);case 12:if(c=t.sent,200===c.code){t.next=16;break}return t.abrupt("return");case 16:e.$message.success(e.$t("tips.successSub"));case 17:case"end":return t.stop()}},t,e)}))()}}},p={render:function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"lb-system-virtual-set"},[t("top-nav"),r._v(" "),t("div",{staticClass:"page-main"},[t("lb-tips",[t("a",{staticClass:"c-link",attrs:{href:"https://migugu.yuque.com/org-wiki-migugu-idxmwf/ubc5ux/xylqo24gfbghh00s?singleDoc=",target:"_blank"}},[r._v("点击查看阿里云虚拟号码配置文档")])]),r._v(" "),t("el-form",{ref:"subForm",attrs:{model:r.subForm,rules:r.subFormRules,"label-width":"160px"},nativeOn:{submit:function(r){r.preventDefault()}}},[t("el-form-item",{attrs:{label:"是否开启虚拟号码",prop:"virtual_status"}},[t("el-radio-group",{model:{value:r.subForm.virtual_status,callback:function(e){r.$set(r.subForm,"virtual_status",e)},expression:"subForm.virtual_status"}},[t("el-radio",{attrs:{label:1}},[r._v(r._s(r.$t("action.ON")))]),r._v(" "),t("el-radio",{attrs:{label:0}},[r._v(r._s(r.$t("action.OFF")))])],1),r._v(" "),t("lb-tool-tips",[r._v("\n          开启后，必须配置阿里云号码池、容联七陌或云信虚拟号码\n          "),t("div",{staticClass:"mt-sm"},[r._v("\n            用于手机端订单信息里面的电话仅显示部分且拨打电话时显示虚拟号码\n          ")])])],1),r._v(" "),1===r.subForm.virtual_status?t("block",[t("el-form-item",{attrs:{label:"虚拟号码运营商",prop:"virtual_type"}},[t("el-radio-group",{model:{value:r.subForm.virtual_type,callback:function(e){r.$set(r.subForm,"virtual_type",e)},expression:"subForm.virtual_type"}},[t("el-radio",{attrs:{label:1}},[r._v("阿里云")]),r._v(" "),t("el-radio",{attrs:{label:2}},[r._v("容联七陌")]),r._v(" "),t("el-radio",{attrs:{label:3}},[r._v("云信")])],1)],1),r._v(" "),1===r.subForm.virtual_type?t("el-form-item",{attrs:{label:"号码池",prop:"pool_key"}},[t("el-input",{attrs:{placeholder:"请输入号码池"},model:{value:r.subForm.pool_key,callback:function(e){r.$set(r.subForm,"pool_key",e)},expression:"subForm.pool_key"}}),r._v(" "),t("lb-tool-tips",[r._v("号码池, 请前往阿里云获取配置 ")])],1):r._e(),r._v(" "),2===r.subForm.virtual_type?t("block",[t("el-form-item",{attrs:{label:"虚拟号模式",prop:"moor_virtual_type"}},[t("el-radio-group",{model:{value:r.subForm.moor_virtual_type,callback:function(e){r.$set(r.subForm,"moor_virtual_type",e)},expression:"subForm.moor_virtual_type"}},[t("el-radio",{attrs:{label:1}},[r._v("普通模式")]),r._v(" "),t("el-radio",{attrs:{label:2}},[r._v("双向回呼模式")])],1)],1),r._v(" "),t("el-form-item",{attrs:{label:"虚拟号码",prop:"moor_phone_arr"}},r._l(r.subForm.moor_phone_arr,function(e,o){return t("div",{key:o,staticClass:"mb-md"},[t("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.phone,callback:function(t){r.$set(e,"phone",t)},expression:"item.phone"}}),r._v(" "),r.subForm.moor_phone_arr.length>1||1===r.subForm.moor_phone_arr.length&&0!==o?t("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(e){return r.toAddItem("moor_phone_arr",2,o)}}},[r._v("删除")]):r._e(),r._v(" "),o===r.subForm.moor_phone_arr.length-1?t("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return r.toAddItem("moor_phone_arr",1)}}},[r._v("新增")]):r._e()],1)}),0)],1):r._e(),r._v(" "),3===r.subForm.virtual_type?t("block",[t("el-form-item",{attrs:{label:"虚拟号码",prop:"winnerlook_phone_arr"}},r._l(r.subForm.winnerlook_phone_arr,function(e,o){return t("div",{key:o,staticClass:"mb-md"},[t("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.phone,callback:function(t){r.$set(e,"phone",t)},expression:"item.phone"}}),r._v(" "),r.subForm.winnerlook_phone_arr.length>1||1===r.subForm.winnerlook_phone_arr.length&&0!==o?t("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(e){return r.toAddItem("winnerlook_phone_arr",2,o)}}},[r._v("删除")]):r._e(),r._v(" "),o===r.subForm.winnerlook_phone_arr.length-1?t("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return r.toAddItem("winnerlook_phone_arr",1)}}},[r._v("新增")]):r._e()],1)}),0)],1):r._e()],1):r._e(),r._v(" "),t("el-form-item",[t("lb-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(e){return r.submitFormInfo("subForm")}}},[r._v(r._s(r.$t("action.submit")))])],1)],1)],1)],1)},staticRenderFns:[]};var c=t("C7Lr")(s,p,!1,function(r){t("11Lc")},"data-v-1333792b",null);e.default=c.exports}});