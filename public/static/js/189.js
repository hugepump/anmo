webpackJsonp([189],{"+vEv":function(t,e){},HdEi:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),o=a.n(n),r=a("lC5x"),i=a.n(r),s=a("rVsN"),c=a.n(s),l=a("KH7x"),u=a.n(l),m=a("J0Oq"),d=a.n(m),p=a("4YfN"),h=a.n(p),_=a("bSIt"),b={data:function(){return{showDialog:{pendant:!1},subForm:{coach_icon_type:0,coach_top_num:"",coach_hot_num:""},subFormRules:{coach_top_num:{required:!0,validator:this.$reg.isNum,text:"皇冠数量",reg_type:2,trigger:"blur"},coach_hot_num:{required:!0,validator:this.$reg.isNum,text:"火苗数量",reg_type:2,trigger:"blur"}},pendantForm:{id:0,title:"",icon:[]},pendantFormRules:{title:{required:!0,validator:this.$reg.isNotNull,text:"挂件名称",reg_type:2,trigger:"blur"},icon:{required:!0,type:"array",message:"请上传挂件图标",trigger:["blur","change"]}},loading:!1,searchForm:{page:1,limit:10,title:""},tableData:[],total:0}},created:function(){this.getFormInfo()},computed:h()({},Object(_.e)({routesItem:function(t){return t.routes}})),methods:{getFormInfo:function(){var t=this;return d()(i.a.mark(function e(){var a,n,o,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.all([t.$api.system.configInfo()]);case 2:for(s in a=e.sent,n=u()(a,1),o=n[0],r=o.data,t.subForm)t.subForm[s]=r[s];1===r.coach_icon_type&&t.getTableDataList(1);case 8:case"end":return e.stop()}},e,t)}))()},handleSizeChange:function(t){this.searchForm.limit=t,this.handleCurrentChange(1)},handleCurrentChange:function(t){this.searchForm.page=t,this.getTableDataList()},getTableDataList:function(t){var e=this;return d()(i.a.mark(function a(){var n,r,s,c;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t&&(e.searchForm.page=t),e.loading=!0,n=JSON.parse(o()(e.searchForm)),a.next=5,e.$api.technician.coachIconList(n);case 5:if(r=a.sent,s=r.code,c=r.data,e.loading=!1,200===s){a.next=11;break}return a.abrupt("return");case 11:e.tableData=c.data,e.total=c.total;case 13:case"end":return a.stop()}},a,e)}))()},toShowDialog:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:0,title:"",icon:[]};for(var a in(e=JSON.parse(o()(e))).icon.length>0&&(e.icon=[{url:e.icon}]),this[t+"Form"])this[t+"Form"][a]=e[a];this.showDialog[t]=!this.showDialog[t],["pendant"].includes(t)&&this.$refs[t+"Form"].validate&&this.$refs[t+"Form"].clearValidate()},getCover:function(t){this.pendantForm.icon=t},toDelItem:function(t){var e=this;return d()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$api.technician.coachIconUpdate({id:t,status:-1});case 2:e.searchForm.page=e.searchForm.page<Math.ceil((e.total-1)/e.searchForm.limit)?e.searchForm.page:Math.ceil((e.total-1)/e.searchForm.limit),e.getTableDataList();case 4:case"end":return a.stop()}},a,e)}))()},submitFormInfo:function(t){var e=this;return d()(i.a.mark(function a(){var n,r,s,c,l,u;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=!0,e.$refs[t+"Form"].validate(function(t){if(!t)return n=!1,!1}),n){a.next=4;break}return a.abrupt("return");case 4:return r=JSON.parse(o()(e[t+"Form"])),"pendant"===t&&(r.icon=r.icon[0].url),s={sub:{methodKey:"system",methodModel:"configUpdate"},pendant:{methodKey:"technician",methodModel:r.id?"coachIconUpdate":"coachIconAdd"}},c=s[t],l=c.methodKey,u=c.methodModel,a.next=10,e.$api[l][u](r);case 10:e.$message.success(e.$t("tips.successSub")),"pendant"===t&&(e.showDialog[t]=!1,e.getTableDataList()),"sub"===t&&1===r.coach_icon_type&&e.getTableDataList(1);case 13:case"end":return a.stop()}},a,e)}))()}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-technician-pendant"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-form",{ref:"subForm",attrs:{model:t.subForm,rules:t.subFormRules,"label-width":"140px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"挂件显示规则",prop:"coach_icon_type"}},[a("el-radio-group",{on:{change:function(e){return t.submitFormInfo("sub")}},model:{value:t.subForm.coach_icon_type,callback:function(e){t.$set(t.subForm,"coach_icon_type",e)},expression:"subForm.coach_icon_type"}},[a("el-radio",{attrs:{label:0}},[t._v("按系统设定展示")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("自定义展示")])],1),t._v(" "),a("lb-tool-tips",[t._v("按系统设定展示：新人标识默认上线前7天展示，皇冠和火苗标识都是根据同一城市的业绩排名来的\n          "),a("div",{staticClass:"mt-sm"},[t._v("\n            自定义展示：不根据业绩和上线时间来展示，后台自定义上传图标，根据"+t._s(t.$t("action.attendantName"))+"关联的挂件来展示\n          ")])]),t._v(" "),a("div",{staticClass:"lb-text-red-tips"},[t._v("\n          开启自定义展示，手机端将不再展示皇冠、火苗、新人标识，需要前往【"+t._s(t.$t("action.attendantName"))+"管理】页面为需要展示挂件的"+t._s(t.$t("action.attendantName"))+"选择挂件。请谨慎操作\n        ")])],1),t._v(" "),0===t.subForm.coach_icon_type?a("block",[a("el-form-item",{attrs:{label:"皇冠数量",prop:"coach_top_num"}},[a("el-input",{attrs:{placeholder:"请输入数量"},model:{value:t.subForm.coach_top_num,callback:function(e){t.$set(t.subForm,"coach_top_num",e)},expression:"subForm.coach_top_num"}}),t._v(" "),a("lb-tool-tips",[t._v("每座城市的皇冠数量，设置了数量X，表示业绩前X名的"+t._s(t.$t("action.attendantName"))+"会有皇冠挂件")])],1),t._v(" "),a("el-form-item",{attrs:{label:"火苗数量",prop:"coach_hot_num"}},[a("el-input",{attrs:{placeholder:"请输入数量"},model:{value:t.subForm.coach_hot_num,callback:function(e){t.$set(t.subForm,"coach_hot_num",e)},expression:"subForm.coach_hot_num"}}),t._v(" "),a("lb-tool-tips",[t._v("每座城市的火苗数量，设置了数量X，表示皇冠"+t._s(t.$t("action.attendantName"))+"后X名"+t._s(t.$t("action.attendantName"))+"有火苗挂件")])],1),t._v(" "),a("el-form-item",[a("lb-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(e){return t.submitFormInfo("sub")}}},[t._v(t._s(t.$t("action.submit")))])],1)],1):t._e()],1),t._v(" "),1===t.subForm.coach_icon_type?a("div",{staticStyle:{"margin-left":"45px"}},[a("lb-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.toShowDialog("pendant")}}},[t._v(t._s(t.$t("menu.TechnicianPendantAdd")))]),t._v(" "),a("el-table",{staticClass:"mt-lg",attrs:{data:t.tableData,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"title",label:"挂件名称","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"icon",label:"挂件图标"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.icon}})]}}],null,!1,3695486500)}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-operate"},[a("lb-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.toShowDialog("pendant",e.row)}}},[t._v(t._s(t.$t("action.edit")))]),t._v(" "),a("lb-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return t.toDelItem(e.row.id)}}},[t._v(t._s(t.$t("action.delete")))])],1)]}}],null,!1,2427099206)})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.page,pageSize:t.searchForm.limit,total:t.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],1):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:t.$t(t.pendantForm.id?"menu.TechnicianPendantEdit":"menu.TechnicianPendantAdd"),visible:t.showDialog.pendant,width:"500px",center:""},on:{"update:visible":function(e){return t.$set(t.showDialog,"pendant",e)}}},[a("el-form",{ref:"pendantForm",staticClass:"dialog-form",attrs:{model:t.pendantForm,rules:t.pendantFormRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"挂件名称",prop:"title"}},[a("el-input",{attrs:{maxlength:"10","show-word-limit":"",placeholder:"请输入挂件名称"},model:{value:t.pendantForm.title,callback:function(e){t.$set(t.pendantForm,"title",e)},expression:"pendantForm.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"挂件图标",prop:"icon"}},[a("lb-cover",{attrs:{fileList:t.pendantForm.icon},on:{selectedFiles:t.getCover}}),t._v(" "),a("lb-tool-tips",[t._v("图片建议尺寸: 400 * 400，图片格式为PNG最佳，图片样式布局请参考：\n          "),a("div",{staticClass:"mt-sm"},[a("a",{staticClass:"c-link",attrs:{href:"https://lbqny.migugu.com/admin/anmo/mine/top1.png",target:"_blank"}},[t._v(t._s(t.$t("action.attendantName"))+"列表样式一「皇冠」")])]),t._v(" "),a("div",{staticClass:"mt-sm"},[a("a",{staticClass:"c-link",attrs:{href:"https://lbqny.migugu.com/admin/anmo/mine/top_3.gif",target:"_blank"}},[t._v(t._s(t.$t("action.attendantName"))+"列表样式三「皇冠」")])]),t._v(" "),a("div",{staticClass:"mt-sm"},[a("a",{staticClass:"c-link",attrs:{href:"https://lbqny.migugu.com/admin/anmo/diy/diy-4-crown-1.png",target:"_blank"}},[t._v(t._s(t.$t("action.attendantName"))+"列表样式四「皇冠」")])])])],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showDialog.pendant=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(e){return t.submitFormInfo("pendant")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=a("C7Lr")(b,v,!1,function(t){a("+vEv")},"data-v-10ad94b6",null);e.default=f.exports}});