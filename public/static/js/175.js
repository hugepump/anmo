webpackJsonp([175],{Bfc9:function(t,e){},iCOu:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),r=a.n(n),i=a("rVsN"),s=a.n(i),l=a("KH7x"),o=a.n(l),c=a("4YfN"),u=a.n(c),m=a("lC5x"),d=a.n(m),p=a("J0Oq"),_=a.n(p),f=a("PxTW"),h=a.n(f),b=a("bSIt"),g={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>1e3*(h()(h()(Date.now()).format("YYYY-MM-DD")).unix()+86400-1)}},btn_config:[],base_city:[],base_agent:[],base_agent_coach:[],base_store:[],base_career:[],base_industry:[],day_list:[],time_list:[],loading:{list:!1},searchForm:{page:1,limit:10,text_type:0,name:"",city_id:"",admin_id:"",type_id:0,industry_type:0},tableData:[],total:0,count:{},timesForm:{id:0,str:""},showDialog:{times:!1}}},created:function(){var t=this;return _()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getBaseInfo();case 2:t.getTableDataList();case 3:case"end":return e.stop()}},e,t)}))()},computed:u()({},Object(b.e)({routesItem:function(t){return t.routes}})),methods:{getBaseInfo:function(){var t=this;return _()(d.a.mark(function e(){var a,n,r,i,l,c,u,m,p;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.all([t.$api.system.getCity(),t.$api.agent.adminSelect(),t.$api.system.btnConfigInfo(),t.$api.technician.typeSelect(),t.$api.technician.dayText()]);case 2:if(a=e.sent,n=o()(a,5),r=n[0],i=n[1],l=n[2],c=n[3],u=n[4],t.base_city=r.data,t.base_agent=i.data,t.btn_config=l.data,c.data.unshift({id:0,title:"全部"}),t.base_industry=c.data,u.data.map(function(t){t.title=t.dat_text+" "+t.week}),t.day_list=u.data,!t.routesItem.auth.career){e.next=23;break}return e.next=19,t.$api.technician.coachTypeSelect();case 19:m=e.sent,(p=m.data).unshift({id:0,title:"全部"}),t.base_career=p;case 23:case"end":return e.stop()}},e,t)}))()},resetForm:function(t){this.$refs[t].resetFields(),this.getTableDataList(1)},handleSizeChange:function(t){this.searchForm.limit=t,this.handleCurrentChange(1)},handleCurrentChange:function(t){this.searchForm.page=t,this.getTableDataList()},toChange:function(t){var e=this;return _()(d.a.mark(function a(){return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.searchForm.text_type=t,e.getTableDataList(1);case 2:case"end":return a.stop()}},a,e)}))()},getTableDataList:function(t){var e=this;return _()(d.a.mark(function a(){var n,i,s,l;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t&&(e.searchForm.page=t),e.tableData=[],e.loading=!0,n=JSON.parse(r()(e.searchForm)),a.next=6,e.$api.technician.coachList(n);case 6:if(i=a.sent,s=i.code,l=i.data,e.loading=!1,200===s){a.next=12;break}return a.abrupt("return");case 12:l.data.map(function(t,e){t.text_type=0===e||e>4?1:e}),e.count=e.$util.pick(l,["all","nopass","ing","pass","update_num"]),e.tableData=l.data,e.total=l.total;case 16:case"end":return a.stop()}},a,e)}))()},getTimeList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return _()(d.a.mark(function n(){var r,i,s;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=!1,a||(a=e.day_list[0].dat_str,r=!0),e.timesForm={id:t,str:a},n.next=5,e.$api.technician.timeText({coach_id:t,day:a});case 5:if(i=n.sent,s=i.data,e.time_list=s,r){n.next=10;break}return n.abrupt("return");case 10:e.showDialog.times=!e.showDialog.times;case 11:case"end":return n.stop()}},n,e)}))()},toUpdateCoachAddr:function(){var t=this;return _()(d.a.mark(function e(){var a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=t.tableData.map(function(t){return t.id})).length){e.next=4;break}return t.$message.error("请先筛选出要更新地址的"+t.$t("action.attendantName")+"数据"),e.abrupt("return");case 4:return e.next=6,t.$api.technician.updateCoachAddress({coach_id:a});case 6:if(n=e.sent,200===n.code){e.next=10;break}return e.abrupt("return");case 10:t.$message.success(t.$t("tips.successOper")),t.getTableDataList();case 12:case"end":return e.stop()}},e,t)}))()},isTimes:function(t){return(new Date).getTime()/1e3>t}},filters:{handleTime:function(t,e){return 1===e?h()(1e3*t).format("YYYY-MM-DD"):2===e?h()(1e3*t).format("HH:mm:ss"):h()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},handleStartEndTime:function(t){var e="",a=t.start_time,n=t.end_time,r=h()(Date.now()).format("YYYY-MM-DD");return a&&n&&(e=h()(r+" "+n).unix()<=h()(r+" "+a).unix()?a+" 至 次日"+n:a+" 至 "+n),e}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-technician-list"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-top-operate"},[a("el-button",{attrs:{type:0===t.searchForm.text_type?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(0)}}},[t._v("全部（"+t._s(t.count.all||0)+"）")]),t._v(" "),a("el-badge",{staticStyle:{margin:"14px 12px 0 0"},style:{marginRight:t.count.ing>99?"32px":t.count.ing>9?"22px":"12px"},attrs:{value:t.count.ing>0?t.count.ing:"",max:99}},[a("el-button",{staticStyle:{"margin-right":"0"},attrs:{type:1===t.searchForm.text_type?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(1)}}},[t._v(t._s(t.btn_config[0].text)),0===t.count.ing?a("span",[t._v("（0）")]):t._e()])],1),t._v(" "),a("el-button",{attrs:{type:2===t.searchForm.text_type?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(2)}}},[t._v(t._s(t.btn_config[1].text)+"（"+t._s(t.count.pass||0)+"）")]),t._v(" "),a("el-button",{attrs:{type:3===t.searchForm.text_type?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(3)}}},[t._v(t._s(t.btn_config[2].text)+"（"+t._s(t.count.nopass||0)+"）")]),t._v(" "),a("el-badge",{staticStyle:{"margin-top":"14px"},style:{marginRight:t.count.update_num>99?"32px":t.count.update_num>9?"22px":"12px"},attrs:{value:t.count.update_num>0?t.count.update_num:"",max:99}},[a("el-button",{staticStyle:{"margin-right":"0"},attrs:{type:4===t.searchForm.text_type?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(4)}}},[t._v(t._s(t.btn_config[3].text)),0===t.count.update_num?a("span",[t._v("（0）")]):t._e()])],1)],1),t._v(" "),a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchForm},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"请输入"+t.$t("action.attendantName")+"姓名/真实姓名/手机号"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属"+t.$t("action.agentName"),prop:"admin_id"}},[a("el-select",{attrs:{placeholder:"请选择"+t.$t("action.agentName"),filterable:"",clearable:""},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.admin_id,callback:function(e){t.$set(t.searchForm,"admin_id",e)},expression:"searchForm.admin_id"}},t._l(t.base_agent,function(t){return a("el-option",{key:t.id,attrs:{label:t.agent_name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"工作城市",prop:"city_id"}},[a("el-select",{attrs:{placeholder:"请选择城市",filterable:"",clearable:""},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.city_id,callback:function(e){t.$set(t.searchForm,"city_id",e)},expression:"searchForm.city_id"}},t._l(t.base_city,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),t.routesItem.auth.career?a("el-form-item",{attrs:{label:"职业类型",prop:"type_id"}},[a("el-select",{attrs:{placeholder:"请选择职业类型",filterable:"",clearable:""},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.type_id,callback:function(e){t.$set(t.searchForm,"type_id",e)},expression:"searchForm.type_id"}},t._l(t.base_career,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1):t._e(),t._v(" "),3===t.routesItem.auth.industrytype?a("el-form-item",{attrs:{label:"职业分类",prop:"industry_type"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.industry_type,callback:function(e){t.$set(t.searchForm,"industry_type",e)},expression:"searchForm.industry_type"}},t._l(t.base_industry,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1):t._e(),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1)}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("searchForm")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"work_img",label:"头像",fixed:""},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.work_img}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"coach_name",label:"姓名",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"true_user_name",label:"真实姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"120"}}),t._v(" "),3===t.routesItem.auth.industrytype?a("el-table-column",{attrs:{prop:"industry_title",label:"职业分类"}}):t._e(),t._v(" "),t.routesItem.auth.career?a("el-table-column",{attrs:{prop:"type_title",label:"职业类型"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"admin_name",label:"所属"+t.$t("action.agentName"),"min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"city_name",label:"接单状态","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"small",type:["primary","danger","success","info"][1*e.row.text_type-1]}},[t._v(t._s(t.btn_config[1*e.row.text_type-1].text))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"online_time",label:"在线时长"}}),t._v(" "),a("el-table-column",{attrs:{prop:"city_name",label:"工作城市"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",width:"350",trigger:"hover"}},[a("div",{staticClass:"f-caption c-title",attrs:{slot:""},slot:"default"},[a("div",{staticClass:"c-caption pb-sm"},[t._v("当前定位：")]),t._v(" "),a("div",{staticStyle:{"max-height":"80vh",overflow:"auto"},domProps:{innerHTML:t._s(e.row.address)}})]),t._v(" "),a("div",{staticClass:"ellipsis-3",attrs:{slot:"reference"},domProps:{innerHTML:t._s(e.row.address)},slot:"reference"})])]}}])},[a("template",{slot:"header"},[a("div",{staticClass:"cursor-pointer",staticStyle:{"margin-top":"7px",padding:"0"},on:{click:t.toUpdateCoachAddr}},[t._v("\n            当前定位"),a("i",{staticClass:"iconfont icon-shuaxin pl-sm c-warning"})])])],2),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"最早可预约","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flex-y-center"},[a("el-tag",{attrs:{size:"small",type:"success"}},[t._v(t._s(e.row.near_time||"-"))]),t._v(" "),a("div",{staticClass:"ml-md f-caption c-link cursor-pointer text-underline",on:{click:function(a){return t.getTimeList(e.row.id)}}},[t._v("\n              查看更多\n            ")])],1)]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.page,pageSize:t.searchForm.limit,total:t.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"可预约时间",visible:t.showDialog.times,width:"800px",center:""},on:{"update:visible":function(e){return t.$set(t.showDialog,"times",e)}}},[a("lb-tips",[t._v("\n        灰色：表示不可预约"),a("span",{staticClass:"ml-md mr-md",staticStyle:{color:"#f12c20"}},[t._v("灰色-忙：表示"+t._s(t.$t("action.attendantName"))+"在该时段有订单")]),a("span",{staticStyle:{color:"#409eff"}},[t._v("灰色-占：表示"+t._s(t.$t("action.attendantName"))+"自己设置了该时段为休息")]),t._v(" "),a("div",{staticClass:"mt-sm"},[t._v("其余情况为可预约")])]),t._v(" "),a("div",{staticClass:"flex-warp pb-lg"},t._l(t.day_list,function(e,n){return a("div",{key:n,staticClass:"flex-center flex-column f-mini-title c-title mr-lg pr-lg cursor-pointer",class:[{"text-bold":t.timesForm.str===e.dat_str}],style:{color:t.timesForm.str===e.dat_str?"#409eff":""},on:{click:function(a){return t.getTimeList(t.timesForm.id,e.dat_str)}}},[t._v("\n          "+t._s(e.title)+"\n          "),a("div",{staticClass:"mt-sm",staticStyle:{width:"50px",height:"2px","border-radius":"2px"},style:{background:t.timesForm.str===e.dat_str?"#409eff":"#fff"}})])}),0),t._v(" "),t.time_list&&t.time_list.length>0?a("block",[a("div",{staticClass:"date-list flex"},t._l(t.time_list,function(e,n){return a("div",{key:n,staticClass:"date-item radius-10 flex-center mr-md mt-md rel",class:t.isTimes(e.time_str)||1==e.is_order||0==e.status&&0==e.is_order&&!t.isTimes(e.time_str)?"":"can-service"},[a("div",{staticClass:"f-mini-title"},[t._v(t._s(e.time_text))]),t._v(" "),0!=e.status||0!=e.is_order||t.isTimes(e.time_str)?t._e():a("div",{staticClass:"abs item-tag flex-center c-base radius"},[t._v("\n              占\n            ")]),t._v(" "),1==e.is_order?a("div",{staticClass:"abs item-tag flex-center c-base radius",staticStyle:{background:"#f12c20"}},[t._v("\n              忙\n            ")]):t._e()])}),0)]):a("div",{staticClass:"mt-sm"},[t._v("暂无时间段")])],1)],1)],1)},staticRenderFns:[]};var y=a("C7Lr")(g,v,!1,function(t){a("Bfc9")},"data-v-1b8f34b1",null);e.default=y.exports}});