webpackJsonp([105],{WlIu:function(e,a){},"hD+u":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("3cXf"),l=t.n(n),r=t("lC5x"),i=t.n(r),s=t("J0Oq"),o=t.n(s),c=t("4YfN"),m=t.n(c),h=t("bSIt"),u=t("PxTW"),d=t.n(u),p={components:{},data:function(){return{options:{},navTitle:"",loading:{list:!1,channel:!1,salesman:!1},searchForm:{list:{page:1,limit:10,salesman_id:""},channel:{page:1,limit:10,status:2,no_salesman:1,admin_id:0,name:""},salesman:{page:1,limit:10,status:2,salesman_id:"",admin_id:0,name:""}},tableData:{list:[],channel:[],salesman:[]},total:{list:0,channel:0,salesman:0},showDialog:{channel:!1,salesman:!1},multipleSelection:[],currentRow:{},channelForm:{salesman_id:0,channel_id:[]},salesmanForm:{id:0,salesman_id:0}}},computed:m()({},Object(h.e)({routesItem:function(e){return e.routes}})),created:function(){var e=this;return o()(i.a.mark(function a(){var t,n,l,r,s,o,c;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=e.$route.query,n=t.id,l=t.name,e.options={id:n,name:l},e.searchForm.list.salesman_id=n,e.searchForm.salesman.salesman_id=n,r=e.routesItem.userInfo,s=r.is_admin,o=r.id,c=r.admin_id,o=(void 0===c?0:c)||o,e.searchForm.channel.admin_id=s?0:o,e.searchForm.salesman.admin_id=s?0:o,e.navTitle="“"+l+"”绑定的"+e.$t("action.channelName")+"数据",e.getTableDataList(1,"list");case 10:case"end":return a.stop()}},a,e)}))()},methods:{resetForm:function(e){var a=e+"Form";this.$refs[a].resetFields(),this.getTableDataList(1,e)},handleSizeChange:function(e,a){this.searchForm[a].limit=e,this.handleCurrentChange(1,a)},handleCurrentChange:function(e,a){this.searchForm[a].page=e,this.getTableDataList("",a)},getTableDataList:function(e,a){var t=this;return o()(i.a.mark(function n(){var r,s,o,c,m,h,u;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e&&(t.searchForm[a].page=e),t.loading[a]=!0,r=JSON.parse(l()(t.searchForm[a])),s={list:{methodKey:"channel",methodModel:"channelList"},channel:{methodKey:"channel",methodModel:"channelList"},salesman:{methodKey:"salesman",methodModel:"salesmanList"}}[a],o=s.methodKey,c=s.methodModel,n.next=7,t.$api[o][c](r);case 7:if(m=n.sent,h=m.code,u=m.data,t.loading[a]=!1,200===h){n.next=13;break}return n.abrupt("return");case 13:t.tableData[a]=u.data,t.total[a]=u.total;case 15:case"end":return n.stop()}},n,t)}))()},confirmDel:function(e){var a=this,t=this.options.name,n=this.$createElement;this.$confirm(n("p",null,[n("p",null,this.$t("tips.confirmDelete")),n("p",{style:"font-size:13px;line-height:1.2;color: red"},"删除后，该"+this.$t("action.channelName")+"下产生的订单，业务员【"+t+"】将不再参与分佣！")]),this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){a.updateItem(e,"list")})},updateItem:function(e,a){var t=this;return o()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.$api.channel.channelUpdate({id:e,salesman_id:0}).then(function(e){200===e.code&&(t.$message.success(t.$t("tips.successDel")),t.searchForm[a].page=t.searchForm[a].page<Math.ceil((t.total[a]-1)/t.searchForm[a].limit)?t.searchForm[a].page:Math.ceil((t.total[a]-1)/t.searchForm[a].limit)),t.getTableDataList("",a)});case 1:case"end":return n.stop()}},n,t)}))()},toShowDialog:function(e){var a=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o()(i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(r in t=JSON.parse(l()(t)),"channel"===e&&(t.channel=[],t.salesman_id=a.options.id),a[e+"Form"])a[e+"Form"][r]=t[r];return a.searchForm[e].name="",n.next=6,a.getTableDataList(1,e);case 6:a.showDialog[e]=!a.showDialog[e];case 7:case"end":return n.stop()}},n,a)}))()},handleSelectionChange:function(e,a){this[a]=e},handleDialogConfirm:function(e){var a=this;if("channel"===e){if(0===this.multipleSelection.length)return void this.$message.error("请选择"+this.$t("action.channelName"));var t=this.multipleSelection.map(function(e){return e.id});this.channelForm.channel_id=t}else{if(null===this.currentRow||!this.currentRow.id)return void this.$message.error("请选择业务员");var n=this.currentRow.id,r=void 0===n?0:n;this.salesmanForm.salesman_id=r}var i=JSON.parse(l()(this[e+"Form"])),s="channel"===e?"bindSalesman":"channelUpdate";this.$api.channel[s](i).then(function(t){200===t.code&&(a.$message.success(a.$t("tips.successSub")),a.showDialog[e]=!1,a.getTableDataList(1,"list"))})}},filters:{handleTime:function(e,a){return 1===a?d()(1e3*e).format("YYYY-MM-DD"):2===a?d()(1e3*e).format("HH:mm:ss"):d()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}}},f={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"lb-salesman-channel"},[t("top-nav",{attrs:{title:e.navTitle,isBack:!0}}),e._v(" "),t("div",{staticClass:"page-main"},[t("el-row",{staticClass:"page-top-operate"},[t("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"SalesmanExamine-bindChannel",expression:"`SalesmanExamine-bindChannel`"}],attrs:{size:"medium",type:"primary",icon:"el-icon-plus"},on:{click:function(a){return e.toShowDialog("channel")}}},[e._v(e._s(e.$t("action.bindChannel")))])],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.list,expression:"loading.list"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.list,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark"}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_id",label:"用户ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"avatarUrl",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"nickName",label:"昵称","min-width":"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_name",label:"姓名","min-width":"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"120"}}),e._v(" "),e.routesItem.auth.channelcate?t("el-table-column",{attrs:{prop:"cate_text",label:"申请渠道","min-width":"120"}}):e._e(),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"table-operate"},[t("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"SalesmanExamine-resetSalesman",expression:"`SalesmanExamine-resetSalesman`"}],attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(t){return e.toShowDialog("salesman",a.row)}}},[e._v(e._s(e.$t("action.resetSalesman")))]),e._v(" "),t("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"SalesmanExamine-deleteChannel",expression:"`SalesmanExamine-deleteChannel`"}],attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(t){return e.confirmDel(a.row.id)}}},[e._v(e._s(e.$t("action.deleteChannel")))])],1)]}}])})],1),e._v(" "),t("lb-page",{attrs:{batch:!1,page:e.searchForm.list.page,pageSize:e.searchForm.list.limit,total:e.total.list},on:{handleSizeChange:function(a){return e.handleSizeChange(a,"list")},handleCurrentChange:function(a){return e.handleCurrentChange(a,"list")}}}),e._v(" "),t("el-dialog",{attrs:{title:e.$t("action.bindChannel"),visible:e.showDialog.channel,width:"900px",top:"5vh",center:""},on:{"update:visible":function(a){return e.$set(e.showDialog,"channel",a)}}},[t("el-row",{staticClass:"page-search-form"},[t("el-form",{ref:"channelForm",staticClass:"dialog-form",attrs:{inline:!0,model:e.searchForm.channel},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入姓名/手机号"},model:{value:e.searchForm.channel.name,callback:function(a){e.$set(e.searchForm.channel,"name",a)},expression:"searchForm.channel.name"}})],1),e._v(" "),t("el-form-item",[t("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(a){return e.getTableDataList(1,"channel")}}},[e._v(e._s(e.$t("action.search")))]),e._v(" "),t("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(a){return e.resetForm("channel")}}},[e._v(e._s(e.$t("action.reset")))])],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.channel,expression:"loading.channel"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.channel,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark"},on:{"selection-change":function(a){return e.handleSelectionChange(a,"multipleSelection")}}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_id",label:"用户ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"avatarUrl",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"nickName",label:"昵称"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_name",label:"姓名"}}),e._v(" "),t("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"110"}}),e._v(" "),e.routesItem.auth.channelcate?t("el-table-column",{attrs:{prop:"cate_text",label:"申请渠道"}}):e._e(),e._v(" "),t("el-table-column",{attrs:{prop:"admin_name",label:"所属"+e.$t("action.agentName")}})],1),e._v(" "),t("lb-page",{attrs:{batch:!1,page:e.searchForm.channel.page,pageSize:e.searchForm.channel.limit,total:e.total.channel},on:{handleSizeChange:function(a){return e.handleSizeChange(a,"channel")},handleCurrentChange:function(a){return e.handleCurrentChange(a,"channel")}}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.showDialog.channel=!1}}},[e._v(e._s(e.$t("action.cancel")))]),e._v(" "),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(a){return e.handleDialogConfirm("channel")}}},[e._v(e._s(e.$t("action.comfirm")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("action.resetSalesman"),visible:e.showDialog.salesman,width:"900px",top:"5vh",center:""},on:{"update:visible":function(a){return e.$set(e.showDialog,"salesman",a)}}},[t("el-row",{staticClass:"page-search-form"},[t("el-form",{ref:"salesmanForm",staticClass:"dialog-form",attrs:{inline:!0,model:e.searchForm.salesman},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入姓名/手机号"},model:{value:e.searchForm.salesman.name,callback:function(a){e.$set(e.searchForm.salesman,"name",a)},expression:"searchForm.salesman.name"}})],1),e._v(" "),t("el-form-item",[t("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(a){return e.getTableDataList(1,"salesman")}}},[e._v(e._s(e.$t("action.search")))]),e._v(" "),t("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(a){return e.resetForm("salesman")}}},[e._v(e._s(e.$t("action.reset")))])],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.salesman,expression:"loading.salesman"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.salesman,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark","highlight-current-row":""},on:{"current-change":function(a){return e.handleSelectionChange(a,"currentRow")}}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_id",label:"用户ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"avatarUrl",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"nickName",label:"昵称","min-width":"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"user_name",label:"姓名","min-width":"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"phone",label:"手机号","min-width":"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"admin_name",label:"所属"+e.$t("action.agentName"),"min-width":"120"}})],1),e._v(" "),t("lb-page",{attrs:{batch:!1,page:e.searchForm.salesman.page,pageSize:e.searchForm.salesman.limit,total:e.total.salesman},on:{handleSizeChange:function(a){return e.handleSizeChange(a,"salesman")},handleCurrentChange:function(a){return e.handleCurrentChange(a,"salesman")}}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.showDialog.salesman=!1}}},[e._v(e._s(e.$t("action.cancel")))]),e._v(" "),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(a){return e.handleDialogConfirm("salesman")}}},[e._v(e._s(e.$t("action.comfirm")))])],1)],1)],1)],1)},staticRenderFns:[]};var v=t("C7Lr")(p,f,!1,function(e){t("WlIu")},"data-v-59cd0c50",null);a.default=v.exports}});