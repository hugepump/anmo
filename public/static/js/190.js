webpackJsonp([190],{"5z2N":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("p00s"),i=a.n(r),n=a("4YfN"),s=a.n(n),o=a("lC5x"),l=a.n(o),c=a("3cXf"),u=a.n(c),m=a("J0Oq"),d=a.n(m),h=a("bSIt"),p=a("Mpzp"),_=a("PxTW"),g=a.n(_),f={data:function(){var e=this;return{pickerOptions:{disabledDate:function(e){return e.getTime()>1e3*(g()(g()(Date.now()).format("YYYY-MM-DD")).unix()+86400-1)}},statusOptions:[{label:"全部",value:0},{label:"未授权微信昵称/头像",value:1},{label:"已授权微信昵称/头像",value:2},{label:"未授权手机号码",value:3},{label:"已授权手机号码",value:4}],sourceTypeList:[{title:"全部",id:-1},{title:"公众号搜索",id:0,tips:"用户通过公众号名称直接搜索关注进入系统的"},{title:this.$t("action.resellerName")+"邀请粉丝",id:2,auth:"reseller",agent:"reseller_auth",tips:"用户进入系统初始方式是通过扫描新用户粉丝海报码或点击"+this.$t("action.resellerName")+"分享链接进入的"},{title:this.$t("action.resellerName")+"邀请下级二维码",id:10,auth:"reseller",agent:"reseller_auth",tips:"用户进入系统初始方式是通过扫描"+this.$t("action.resellerName")+"的邀请下级"+this.$t("action.resellerName")+"海报码进入的"},{title:"业务员邀请"+this.$t("action.channelName")+"二维码",id:8,auth:"salesman",agent:"salesman_auth",tips:"用户进入系统初始方式是通过扫描某业务员出示的邀请"+this.$t("action.channelName")+"海报码进入系统的"},{title:"原生渠道码",id:9,auth:"channel",agent:"channel_auth",tips:"用户进入系统的初始方式是通过扫描某个"+this.$t("action.channelName")+"的默认码进入系统的"},{title:"渠道码",id:1,auth:"channel",agent:"channel_auth",tips:"用户进入系统的初始方式是通过扫描某个渠道码进入系统的"},{title:this.$t("action.brokerName")+"邀请"+this.$t("action.attendantName")+"二维码",id:3,auth:"coachbroker",agent:"partner_auth",tips:"用户进入系统初始方式是通过扫描了某个"+this.$t("action.brokerName")+"的邀请"+this.$t("action.attendantName")+"入驻海报码进入的"},{title:this.$t("action.attendantName")+"邀请用户充值",id:7,agent:"agent_coach_auth",tips:"用户进入系统初始方式是通过扫描某"+this.$t("action.attendantName")+"出示的邀请充值海报码进入系统的"},{title:this.$t("action.attendantName")+"邀请用户购买折扣卡",id:14,auth:"balancediscount",agent:"agent_coach_auth",tips:"用户进入系统初始方式是通过扫描某"+this.$t("action.attendantName")+"出示的邀请购买折扣卡海报码进入系统的"},{title:this.$t("action.attendantName")+"邀请用户购买会员卡",id:13,auth:"memberdiscount",agent:"agent_coach_auth",tips:"用户进入系统初始方式是通过扫描某"+this.$t("action.attendantName")+"出示的邀请购买会员卡海报码进入系统的"},{title:this.$t("action.agentName")+"邀请"+this.$t("action.resellerName")+"二维码",id:11,auth:"reseller",agent:"reseller_auth",tips:"用户进入系统初始方式是通过扫描了"+this.$t("action.agentName")+"的邀请"+this.$t("action.resellerName")+"海报码进入的"},{title:this.$t("action.agentName")+"邀请业务员二维码",id:5,auth:"salesman",agent:"salesman_auth",tips:"用户进入系统初始方式是通过扫描某"+this.$t("action.agentName")+"出示的邀请业务员海报码进入的"},{title:this.$t("action.agentName")+"邀请"+this.$t("action.channelName")+"二维码",id:6,auth:"channel",agent:"channel_auth",tips:"用户进入系统初始方式是通过扫描某"+this.$t("action.agentName")+"出示的邀请"+this.$t("action.channelName")+"海报码进入的"},{title:this.$t("action.agentName")+"邀请"+this.$t("action.attendantName")+"二维码",id:4,agent:"agent_coach_auth",tips:"用户进入系统初始方式是通过扫描了某"+this.$t("action.agentName")+"的邀请"+this.$t("action.attendantName")+"海报码进入的"},{title:this.$t("action.agentName")+"邀请"+this.$t("action.agentName")+"二维码",id:12,agent:"sub_agent_auth",tips:"用户进入系统初始方式是通过扫描了"+this.$t("action.agentName")+"的邀请"+this.$t("action.agentName")+"海报码进入的"}],typeText:{1:"充值",2:"消费",3:"消费退款",4:"消费",5:"扣款"},is_show:!1,base_member:[],base_memberdiscount:[],areaOptions:[],downloadLoading:!1,loading:{list:!1,pay:!1,record:!1,growthrecord:!1,label:!1},searchForm:{list:{page:1,limit:10,id:"",nickName:"",start_time:"",end_time:"",type:0,user_status:1,card_id:"",source_type:-1,city_area:[]},pay:{page:1,limit:10,nickName:"",status:1},record:{page:1,limit:10,user_id:""},growthrecord:{page:1,limit:10,id:""},label:{page:1,limit:10,user_id:""}},tableData:{list:[],pay:[],record:[],growthrecord:[],label:[]},total:{list:0,pay:0,record:0,growthrecord:0,label:0},showDialog:{pay:!1,record:!1,growth:!1,growthrecord:!1,label:!1},currentRow:{},payForm:{id:"",nickName:"",avatarUrl:"",phone:"",balance:"",type:1,card_id:0,price:"",text:""},payFormRules:{type:{required:!0,type:"number",message:"请选择充值方式",trigger:"blur"},price:{required:!0,validator:function(t,a,r){var i=e.payForm.type,n=2===i?"充值金额":"减扣金额";1===i||""!==a&&/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(a)&&1*a!=0?r():r(new Error(""===a?"请输入"+n:"请输入正确的金额，最多保留2位小数"))},trigger:"blur"},text:{required:!0,validator:this.$reg.isNotNull,text:"备注内容",reg_type:2,trigger:"blur"}},growthForm:{id:"",nickName:"",avatarUrl:"",phone:"",growth:"",new_growth:"",type:1},growthFormRules:{new_growth:{required:!0,validator:this.$reg.isNum,reg_type:2,text:"成长值",trigger:"blur"}},labelForm:{}}},created:function(){var e=this;return d()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(a=JSON.parse(u()(p.regionData))).map(function(e){if("500000"===e.value){var t=e.children[0].children,a=e.children[1].children;e.children[0].children=t.concat(a),e.children=[e.children[0]]}e.children.map(function(e){e.children&&e.children.length>0&&(e.children=e.children.filter(function(e){return"市辖区"!==e.label}))})}),e.areaOptions=a;case 3:case"end":return t.stop()}},t,e)}))()},activated:function(){var e=this;return d()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=1,Number(window.sessionStorage.getItem("currentPage"))&&(a=Number(window.sessionStorage.getItem("currentPage")),window.sessionStorage.removeItem("currentPage")),e.getBaseInfo(),e.getTableDataList(a,"list");case 4:case"end":return t.stop()}},t,e)}))()},beforeRouteLeave:function(e,t,a){"CustomUserDetail"===e.name&&window.sessionStorage.setItem("currentPage",this.searchForm.list.page),a()},computed:s()({},Object(h.e)({routesItem:function(e){return e.routes}})),methods:{getBaseInfo:function(){var e=this;return d()(l.a.mark(function t(){var a,r,i,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.routesItem.auth.memberdiscount,!(void 0!==a&&a)){t.next=10;break}return t.next=4,e.$api.memberdiscount.cardSelect();case 4:if(r=t.sent,i=r.code,n=r.data,200===i){t.next=9;break}return t.abrupt("return");case 9:e.base_memberdiscount=n;case 10:case"end":return t.stop()}},t,e)}))()},resetForm:function(e){var t=e+"Form",a=this.searchForm.list.sort,r=void 0===a?0:a;delete this.searchForm.list.sort,this.$refs[t].resetFields(),r&&(this.$refs.dateSort_1.columnConfig.order=""),this.getTableDataList(1,e)},handleSizeChange:function(e,t){this.searchForm[t].limit=e,this.handleCurrentChange(1,t)},handleCurrentChange:function(e,t){this.searchForm[t].page=e,this.getTableDataList("",t)},sortChange:function(e){var t=e.order;null===t?delete this.searchForm.list.sort:this.searchForm.list.sort="ascending"===t?2:1,this.getTableDataList(1,"list")},getTableDataList:function(e,t){var a=this;return d()(l.a.mark(function r(){var i,n,s,o,c,m,d,h,p,_,g,f,v;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e&&(a.searchForm[t].page=e),a.loading[t]=!0,i=JSON.parse(u()(a.searchForm[t])),"list"===t&&(n=i.start_time,s=i.city_area,o=void 0===s?[]:s,n&&n.length>1?(i.start_time=n[0]/1e3,i.end_time=n[1]/1e3):(i.start_time="",i.end_time=""),o&&o.length>0&&(c=o[0],m=o.length>1?o[1]:"",d=o.length>2?o[2]:"",(m.includes("市辖区")||"重庆市"===c&&m.includes("县"))&&(m=c),c.includes("特别行政区")&&(d=m,m=c),m.includes("直辖县级行政区划")&&(m=d),i.province=c,i.city=m,i.area=d),1*i.source_type==-1&&delete i.source_type,delete i.city_area),h={list:{methodKey:"custom",methodModel:"userList"},pay:{methodKey:"finance",methodModel:"cardList"},record:{methodKey:"finance",methodModel:"payWater"},growthrecord:{methodKey:"custom",methodModel:"userGrowthList"},label:{methodKey:"custom",methodModel:"coachCommentUserData"}}[t],p=h.methodKey,_=h.methodModel,r.next=8,a.$api[p][_](i);case 8:if(g=r.sent,f=g.code,v=g.data,a.loading[t]=!1,200===f){r.next=14;break}return r.abrupt("return");case 14:"record"===t&&v.data.map(function(e){e.price=Math.abs(e.price)}),"label"===t&&(1===i.page&&(a.labelForm=v.user_label),v.list.data.map(function(e){e.text=e.text?e.text.replace(/\n/g,"<br>"):"暂无内容"})),a.tableData[t]="label"===t?v.list.data:v.data,a.total[t]="label"===t?v.list.total:v.total;case 18:case"end":return r.stop()}},r,a)}))()},confirmDel:function(e,t){var a=this;this.$confirm("操作后，该用户不再展示在客户列表里，如需查看，请在【客户黑名单】里查看，确认需要拉黑用户吗？",this.$t("tips.reminder"),{confirmButtonText:"确认",cancelButtonText:"我再想想",type:"warning"}).then(function(){a.updateItem(e,t)}).catch(function(){})},updateItem:function(e,t){var a=this;return d()(l.a.mark(function r(){var i;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.$api.custom.BlockUser({user_id:e,user_status:t});case 2:if(i=r.sent,200===i.code){r.next=6;break}return r.abrupt("return");case 6:a.$message.success(a.$t("tips.successOper")),a.searchForm.list.page=a.searchForm.list.page<Math.ceil((a.total.list-1)/a.searchForm.list.limit)?a.searchForm.list.page:Math.ceil((a.total.list-1)/a.searchForm.list.limit),a.getTableDataList("","list");case 9:case"end":return r.stop()}},r,a)}))()},toDelLabel:function(e,t){var a=this;return d()(l.a.mark(function r(){var i;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.$api.custom.delUserLabel({user_id:e,label_id:t});case 2:if(i=r.sent,200===i.code){r.next=6;break}return r.abrupt("return");case 6:a.$message.success(a.$t("tips.successDel")),a.getTableDataList("","list");case 8:case"end":return r.stop()}},r,a)}))()},toShowLabel:function(){this.is_show=!this.is_show},handleMenuCommand:function(e,t){var a=t.id;switch(e){case"memberGrowthChange":this.toShowDialog("growth",t);break;case"helpPayBalanceOrder":this.toShowDialog("pay",t);break;case"hideUserType":this.confirmDel(a,-1)}},toShowDialog:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(l.a.mark(function r(){var i,n;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=JSON.parse(u()(a)),["record","growthrecord","label"].includes(e)&&(i=["record","label"].includes(e)?"user_id":"id",t.searchForm[e][i]=a.id),["pay","growth"].includes(e))for(n in a.type=1,"pay"===e&&(a.card_id=0,a.price="",t.searchForm[e].title=""),"growth"===e&&(a.new_growth=""),t[e+"Form"])t[e+"Form"][n]=a[n];if("growth"===e){r.next=6;break}return r.next=6,t.getTableDataList(1,e);case 6:if("growth"!==e){r.next=9;break}return r.next=9,t.getMemberInfo();case 9:t.showDialog[e]=!t.showDialog[e],["pay","growth"].includes(e)&&t.$refs[e+"Form"].validate&&t.$refs[e+"Form"].clearValidate();case 11:case"end":return r.stop()}},r,t)}))()},getMemberInfo:function(){var e=this;return d()(l.a.mark(function t(){var a,r,i,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.routesItem.auth.member,!(void 0!==a&&a)){t.next=10;break}return t.next=4,e.$api.member.levelSelect();case 4:if(r=t.sent,i=r.code,n=r.data,200===i){t.next=9;break}return t.abrupt("return");case 9:e.base_member=n;case 10:case"end":return t.stop()}},t,e)}))()},handleSelectionChange:function(e){this.currentRow=e},submitFormInfo:function(e){var t=this;return d()(l.a.mark(function a(){var r,i,n,s,o,c,m,d,h,p,_,g,f,v,b,w,y;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=!0,i=JSON.parse(u()(t[e+"Form"])),("pay"===e&&1!==i.type||"pay"!==e)&&t.$refs[e+"Form"].validate(function(e){e||(r=!1)}),r){a.next=5;break}return a.abrupt("return");case 5:if(n={},s=i.id,o=i.card_id,c=void 0===o?0:o,m=i.type,d=i.price,h=void 0===d?0:d,p=i.growth,_=i.new_growth,g=i.text,"pay"!==e){a.next=19;break}if(n={user_id:[s],card_id:c,text:g},1!==m){a.next=17;break}if(null!==t.currentRow&&t.currentRow.id){a.next=13;break}return t.$message.error("请选择充值套餐"),a.abrupt("return");case 13:f=t.currentRow.id,n.card_id=f,a.next=18;break;case 17:n.price=h;case 18:3===m&&(n.is_add=-1);case 19:if("growth"!==e){a.next=24;break}if(n={id:s,is_add:m,growth:_,text:g},m||!(1*_>1*p)){a.next=24;break}return t.$message.error("扣减成长值不能大于原成长值！"),a.abrupt("return");case 24:return v={pay:{methodKey:"finance",methodModel:"payBalanceOrder"},growth:{methodKey:"custom",methodModel:"updateUserGrowth"}}[e],b=v.methodKey,w=v.methodModel,a.next=28,t.$api[b][w](n);case 28:if(y=a.sent,200===y.code){a.next=32;break}return a.abrupt("return");case 32:t.$message.success(t.$t("tips.successSub")),t.showDialog[e]=!1,t.getTableDataList("","list");case 35:case"end":return a.stop()}},a,t)}))()},toExportExcel:function(){var e=this,t=this.total.list;if(t>1e4)this.$message.error("最多只能导出10000条数据，当前"+t+"条，请筛选数据点击搜索后再操作导出数据！");else{var a=JSON.parse(u()(this.searchForm.list)),r=a.start_time,n=a.city_area,s=void 0===n?[]:n;if(r&&r.length>1)if(a.start_time=r[0]/1e3,a.end_time=r[1]/1e3,(a.end_time-a.start_time)/86400>30)this.$message.error("请重新选择加入时间，最多可导出30天的数据！");else{if(this.downloadLoading=!0,s&&s.length>0){var o=s[0],l=s.length>1?s[1]:"",c=s.length>2?s[2]:"";(l.includes("市辖区")||"重庆市"===o&&l.includes("县"))&&(l=o),o.includes("特别行政区")&&(c=l,l=o),l.includes("直辖县级行政区划")&&(l=c),a.province=o,a.city=l,a.area=c}1*a.source_type==-1&&delete a.source_type,delete a.city_area;var m=this.$util.getProCurrentHref(),d=m.indexOf("?")>0?"":"?",h=m.indexOf("?")>0;i()(a).forEach(function(e,t){d+=h?"&"+e+"="+a[e]:e+"="+a[e],h=!0});var p=window.localStorage.getItem("massage_minitk"),_=m+"/massage/admin/AdminExcel/userList"+d+"&token="+p;window.location.href=_,setTimeout(function(){e.downloadLoading=!1},5e3)}else this.$message.error("请选择加入时间，最多可导出30天的数据！")}}},filters:{handleTime:function(e,t){return 1===t?g()(1e3*e).format("YYYY-MM-DD"):2===t?g()(1e3*e).format("HH:mm:ss"):3===t?g()(1e3*e).format("YYYY.MM.DD"):g()(1e3*e).format("YYYY-MM-DD HH:mm:ss")},handleTitle:function(e,t,a){var r=t.filter(function(t){return t.id===e}),i=r&&r.length>0?r[0].title:"";return 1*e>0&&a&&null!==a?a+"-"+i:i}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lb-custom-user-list"},[a("top-nav"),e._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"listForm",attrs:{inline:!0,model:e.searchForm.list},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"nickName"}},[a("el-input",{attrs:{placeholder:"请输入微信昵称/手机号"},model:{value:e.searchForm.list.nickName,callback:function(t){e.$set(e.searchForm.list,"nickName",t)},expression:"searchForm.list.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户ID",prop:"id"}},[a("el-input",{attrs:{placeholder:"请输入用户ID"},model:{value:e.searchForm.list.id,callback:function(t){e.$set(e.searchForm.list,"id",t)},expression:"searchForm.list.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.list.type,callback:function(t){e.$set(e.searchForm.list,"type",t)},expression:"searchForm.list.type"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),e.routesItem.auth.memberdiscount?a("el-form-item",{attrs:{label:"会员等级",prop:"card_id"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.list.card_id,callback:function(t){e.$set(e.searchForm.list,"card_id",t)},expression:"searchForm.list.card_id"}},e._l(e.base_memberdiscount,function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"客户来源",prop:"source_type"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.list.source_type,callback:function(t){e.$set(e.searchForm.list,"source_type",t)},expression:"searchForm.list.source_type"}},e._l(e.sourceTypeList,function(t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0===t.id||(!t.auth&&0!==t.id||t.auth&&e.routesItem.auth[t.auth])&&(e.routesItem.userInfo.is_admin||!e.routesItem.userInfo.is_admin&&(!t.agent||t.agent&&e.routesItem.auth[t.agent]))&&(![1,8].includes(t.id)||1===t.id&&e.routesItem.auth.channelqrcount||8===t.id&&e.routesItem.auth.channel&&(e.routesItem.userInfo.is_admin||!e.routesItem.userInfo.is_admin&&e.routesItem.auth.channel_auth)),expression:"\n                item.id === 0 ||\n                (((!item.auth && item.id !== 0) ||\n                  (item.auth && routesItem.auth[item.auth])) &&\n                  (routesItem.userInfo.is_admin ||\n                    (!routesItem.userInfo.is_admin &&\n                      (!item.agent ||\n                        (item.agent && routesItem.auth[item.agent])))) &&\n                  (![1, 8].includes(item.id) ||\n                    (item.id === 1 && routesItem.auth.channelqrcount) ||\n                    (item.id === 8 &&\n                      routesItem.auth.channel &&\n                      (routesItem.userInfo.is_admin ||\n                        (!routesItem.userInfo.is_admin &&\n                          routesItem.auth.channel_auth)))))\n              "}],key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所在地区",prop:"city_area"}},[a("el-cascader",{attrs:{size:"large",clearable:"",options:e.areaOptions,placeholder:"请选择客户所在地区",props:{checkStrictly:!0,value:"label"}},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.list.city_area,callback:function(t){e.$set(e.searchForm.list,"city_area",t)},expression:"searchForm.list.city_area"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"加入时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp","picker-options":e.pickerOptions,"default-time":["00:00:00","23:59:59"]},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.list.start_time,callback:function(t){e.$set(e.searchForm.list,"start_time",t)},expression:"searchForm.list.start_time"}})],1),e._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTableDataList(1,"list")}}},[e._v(e._s(e.$t("action.search")))]),e._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("list")}}},[e._v(e._s(e.$t("action.reset")))])],1)],1)],1),e._v(" "),a("el-row",{staticClass:"page-top-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:e.$route.name+"-export",expression:"`${$route.name}-export`"}],attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:e.toExportExcel}},[e._v("\n        "+e._s(e.$t("action.export")))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.list,expression:"loading.list"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.list,"header-cell-style":{background:"#f5f7fa",color:"#606266"}},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"微信昵称",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.nickName)+"\n          "),e._v(" "),-1===t.row.status||t.row.is_del?a("div",{staticClass:"f-icontext c-warning",staticStyle:{"line-height":"1.2"}},[e._v("\n            "+e._s(-1===t.row.status?"用户已注销":"注销过")+"\n          ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"avatarUrl",label:"微信头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号","min-width":"110"}}),e._v(" "),e.routesItem.auth.member||e.routesItem.auth.memberdiscount?a("el-table-column",{attrs:{prop:"member_level",label:"会员等级","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.routesItem.auth.member?a("div",[e._v("\n            "+e._s(t.row.member_level||"")+"\n          ")]):e._e(),e._v(" "),e.routesItem.auth.memberdiscount?a("div",[e._v("\n            "+e._s(t.row.member_discount_title||"")+"\n            "),t.row.member_discount_title&&1*t.row.member_discount_time>0?a("p",{staticClass:"f-icontext c-warning",staticStyle:{"line-height":"1.2"}},[e._v("\n              "+e._s(e._f("handleTime")(t.row.member_discount_time,3))+"过期\n            ")]):e._e()]):e._e()]}}],null,!1,1064921936)}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"user_use_cash",label:"","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          ¥"+e._s(t.row.user_use_cash)+"\n        ")]}}])},[a("template",{slot:"header"},[a("div",{staticStyle:{"margin-top":"7px",padding:"0"}},[e._v("\n            消费总金额"),a("lb-tool-tips",{attrs:{padding:"10"}},[e._v("包含支付下单和储值消费的金额")])],1)])],2),e._v(" "),a("el-table-column",{ref:"dateSort_1",attrs:{prop:"balance",label:"账户余额",sortable:"balance","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ¥"+e._s(t.row.balance)+" ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"user_use_cash",label:"","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("handleTitle")(t.row.source_type,e.sourceTypeList,t.row.channel_qr))+"\n        ")]}}])},[a("template",{slot:"header"},[a("div",{staticStyle:{"margin-top":"7px",padding:"0"}},[e._v("\n            客户来源"),a("lb-tool-tips",{attrs:{padding:"10"}},[a("div",{staticClass:"mb-md"},[e._v("客户来源方式有以下几种：")]),e._v(" "),e._l(e.sourceTypeList,function(t,r){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.id||(!t.auth&&0!==t.id||t.auth&&e.routesItem.auth[t.auth])&&(e.routesItem.userInfo.is_admin||!e.routesItem.userInfo.is_admin&&(!t.agent||t.agent&&e.routesItem.auth[t.agent]))&&(![1,8].includes(t.id)||1===t.id&&e.routesItem.auth.channelqrcount||8===t.id&&e.routesItem.auth.channel&&(e.routesItem.userInfo.is_admin||!e.routesItem.userInfo.is_admin&&e.routesItem.auth.channel_auth)),expression:"\n                  item.id === 0 ||\n                  (((!item.auth && item.id !== 0) ||\n                    (item.auth && routesItem.auth[item.auth])) &&\n                    (routesItem.userInfo.is_admin ||\n                      (!routesItem.userInfo.is_admin &&\n                        (!item.agent ||\n                          (item.agent && routesItem.auth[item.agent])))) &&\n                    (![1, 8].includes(item.id) ||\n                      (item.id === 1 && routesItem.auth.channelqrcount) ||\n                      (item.id === 8 &&\n                        routesItem.auth.channel &&\n                        (routesItem.userInfo.is_admin ||\n                          (!routesItem.userInfo.is_admin &&\n                            routesItem.auth.channel_auth)))))\n                "}],key:r,staticClass:"mt-sm"},[e._v("\n                "+e._s(t.title)+"："+e._s(t.tips)+"\n              ")])})],2)],1)])],2),e._v(" "),a("el-table-column",{attrs:{prop:"province",label:"所在地区","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s((t.row.province||"")+" "+(t.row.city||"")+" "+(t.row.area||""))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"加入时间","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(e._f("handleTime")(t.row.create_time,1)))]),e._v(" "),a("p",[e._v(e._s(e._f("handleTime")(t.row.create_time,2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:e.routesItem.userInfo.is_admin?"200":"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-operate"},[a("lb-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return e.$router.push("/custom/user/detail?id="+t.row.id)}}},[e._v(e._s(e.$t("action.view")))]),e._v(" "),e.routesItem.auth.member&&e.$route.meta.pagePermission[0].auth.includes("memberGrowthChange")||e.$route.meta.pagePermission[0].auth.includes("helpPayBalanceOrder")||e.$route.meta.pagePermission[0].auth.includes("hideUserType")?a("el-dropdown",{on:{command:function(a){return e.handleMenuCommand(a,t.row)}}},[a("el-button",{attrs:{type:"danger",plain:"",size:"mini"}},[e._v("\n                更多菜单"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:e.routesItem.auth.member&&e.$route.meta.pagePermission[0].auth.includes("memberGrowthChange"),expression:"\n                    routesItem.auth.member &&\n                    $route.meta.pagePermission[0].auth.includes(\n                      'memberGrowthChange'\n                    )\n                  "}],attrs:{command:"memberGrowthChange"}},[e._v(e._s(e.$t("action.memberGrowthChange")))]),e._v(" "),a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:e.$route.meta.pagePermission[0].auth.includes("helpPayBalanceOrder"),expression:"\n                    $route.meta.pagePermission[0].auth.includes(\n                      'helpPayBalanceOrder'\n                    )\n                  "}],attrs:{command:"helpPayBalanceOrder"}},[e._v(e._s(e.$t("action.helpPayBalanceOrder")))]),e._v(" "),a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:e.$route.meta.pagePermission[0].auth.includes("hideUserType"),expression:"\n                    $route.meta.pagePermission[0].auth.includes(\n                      'hideUserType'\n                    )\n                  "}],attrs:{command:"hideUserType"}},[e._v(e._s(e.$t("action.hideUserType")))])],1)],1):e._e()],1)]}}])})],1),e._v(" "),a("lb-page",{attrs:{batch:!1,page:e.searchForm.list.page,pageSize:e.searchForm.list.limit,total:e.total.list},on:{handleSizeChange:function(t){return e.handleSizeChange(t,"list")},handleCurrentChange:function(t){return e.handleCurrentChange(t,"list")}}}),e._v(" "),a("el-dialog",{staticClass:"dialog-form",attrs:{title:e.$t("action.helpPayBalanceOrder"),visible:e.showDialog.pay,width:"800px",top:"5vh",center:""},on:{"update:visible":function(t){return e.$set(e.showDialog,"pay",t)}}},[a("el-form",{ref:"payForm",attrs:{model:e.payForm,rules:e.payFormRules,"label-width":"120px"}},[a("div",{staticClass:"flex-center",staticStyle:{margin:"0 0 10px 48px"}},[a("lb-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.payForm.avatarUrl,isLook:!0}}),e._v(" "),a("div",{staticClass:"flex-1 ml-md f-caption c-caption"},[a("div",{staticClass:"f-paragraph c-title text-bold"},[e._v("\n              "+e._s(e.payForm.nickName)+"\n            ")]),e._v(" "),e.payForm.phone?a("div",{staticClass:"mt-sm"},[e._v("\n              "+e._s(e.payForm.phone)+"\n            ")]):e._e(),e._v(" "),a("div",{staticClass:"mt-sm"},[e._v("\n              原账户余额："),a("span",{staticClass:"c-warning"},[e._v("¥"+e._s(e.payForm.balance))])])])],1),e._v(" "),a("el-form-item",{attrs:{label:"选择储值方式",prop:"type"}},[a("el-radio-group",{model:{value:e.payForm.type,callback:function(t){e.$set(e.payForm,"type",t)},expression:"payForm.type"}},[a("el-radio",{attrs:{label:1}},[e._v("选择充值套餐")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("自定义充值")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("减扣余额")])],1)],1),e._v(" "),1===e.payForm.type?a("el-form-item",{attrs:{label:"充值套餐",prop:"user"}},[a("div",{staticStyle:{width:"600px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.pay,expression:"loading.pay"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.pay,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark","highlight-current-row":""},on:{"current-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"title",label:"套餐名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"购买价格",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  ¥"+e._s(t.row.price)+"\n                ")]}}],null,!1,1547869429)}),e._v(" "),a("el-table-column",{attrs:{prop:"true_price",label:"实际充值",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  ¥"+e._s(t.row.true_price)+"\n                ")]}}],null,!1,2061991772)})],1)],1)]):a("el-form-item",{attrs:{label:2===e.payForm.type?"充值金额":"减扣金额",prop:"price"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:2===e.payForm.type?"请输入充值金额":"请输入减扣金额"},model:{value:e.payForm.price,callback:function(t){e.$set(e.payForm,"price",t)},expression:"payForm.price"}})],1),e._v(" "),1===e.payForm.type?a("div",{staticClass:"pr-lg pb-lg"},[a("lb-page",{attrs:{batch:!1,page:e.searchForm.pay.page,pageSize:e.searchForm.pay.limit,total:e.total.pay},on:{handleSizeChange:function(t){return e.handleSizeChange(t,"pay")},handleCurrentChange:function(t){return e.handleCurrentChange(t,"pay")}}})],1):e._e(),e._v(" "),1!==e.payForm.type?a("el-form-item",{attrs:{label:"备注",prop:"text"}},[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入备注",type:"textarea",rows:10,maxlength:"300","show-word-limit":""},model:{value:e.payForm.text,callback:function(t){e.$set(e.payForm,"text",t)},expression:"payForm.text"}})],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showDialog.pay=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(t){return e.submitFormInfo("pay")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("action.memberGrowthChange"),visible:e.showDialog.growth,width:"600px",center:""},on:{"update:visible":function(t){return e.$set(e.showDialog,"growth",t)}}},[a("el-form",{ref:"growthForm",staticClass:"dialog-form",attrs:{model:e.growthForm,rules:e.growthFormRules,"label-width":"120px"}},[a("div",{staticClass:"flex-center",staticStyle:{margin:"0 0 10px 48px"}},[a("lb-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.growthForm.avatarUrl,isLook:!0}}),e._v(" "),a("div",{staticClass:"flex-1 ml-md f-caption c-caption"},[a("div",{staticClass:"f-paragraph c-title text-bold"},[e._v("\n              "+e._s(e.growthForm.nickName)+"\n            ")]),e._v(" "),e.growthForm.phone?a("div",{staticClass:"mt-sm"},[e._v("\n              "+e._s(e.growthForm.phone)+"\n            ")]):e._e(),e._v(" "),a("div",{staticClass:"mt-sm"},[e._v("\n              原成长值："),a("span",{staticClass:"c-warning"},[e._v(e._s(e.growthForm.growth))])])])],1),e._v(" "),a("el-form-item",{attrs:{label:"选择增减方式",prop:"type"}},[a("el-radio-group",{model:{value:e.growthForm.type,callback:function(t){e.$set(e.growthForm,"type",t)},expression:"growthForm.type"}},[a("el-radio",{attrs:{label:1}},[e._v("增加成长值")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("减扣成长值")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:1===e.growthForm.type?"增加成长值":"减扣成长值",prop:"new_growth"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入成长值"},model:{value:e.growthForm.new_growth,callback:function(t){e.$set(e.growthForm,"new_growth",t)},expression:"growthForm.new_growth"}})],1)],1),e._v(" "),a("div",{staticClass:"f-desc c-title",staticStyle:{margin:"30px 0 0 20px"}},e._l(e.base_member,function(t,r){return a("div",{key:r,staticClass:"flex-center mt-md"},[a("div",{staticClass:"text-right",staticStyle:{width:"150px"}},[e._v("\n            "+e._s(t.title)+"\n          ")]),e._v(" "),a("div",{staticClass:"flex-1 pl-lg"},[e._v("达成"+e._s(t.growth)+"成长值")])])}),0),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showDialog.growth=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(t){return e.submitFormInfo("growth")}}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var b=a("C7Lr")(f,v,!1,function(e){a("VDTn")},"data-v-10032135",null);t.default=b.exports},VDTn:function(e,t){}});