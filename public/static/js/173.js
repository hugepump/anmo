webpackJsonp([173],{"3W9P":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),r=a.n(n),i=a("lC5x"),s=a.n(i),o=a("aA9S"),c=a.n(o),l=a("rVsN"),m=a.n(l),_=a("KH7x"),u=a.n(_),d=a("J0Oq"),v=a.n(d),p=a("4YfN"),b=a.n(p),f=a("bSIt"),g={components:{},data:function(){var t=this;return{longOptions:[{id:3,title:"近3天"},{id:5,title:"近5天"},{id:7,title:"近7天"}],timeOptions:[{id:15,title:"15分钟"},{id:30,title:"半小时"},{id:60,title:"一小时"},{id:120,title:"两小时"}],order:["empty_order_cash","coach_empty_cash","admin_empty_cash","after_service_can_refund","cash_list","coach_refund_comm","admin_refund_comm"],subForm:{over_time:"",time_interval:"",max_day:"",time_unit:"",service_start_recording:"",countdown_voice:"",service_end_recording:"",empty_order_cash:"",coach_empty_cash:"",admin_empty_cash:"",after_service_can_refund:"",cash_list:[],coach_refund_comm:"",admin_refund_comm:"",order_pay_timeout_remind:""},subFormRules:{over_time:{required:!0,validator:this.$reg.isNum,reg_type:2,text:"分钟数",trigger:"blur"},time_interval:{required:!0,validator:this.$reg.isNum,reg_type:2,text:"分钟数",trigger:"blur"},max_day:{required:!0,type:"number",message:"请选择最长预约",trigger:"blur"},time_unit:{required:!0,type:"number",message:"请选择时长单位",trigger:"blur"},empty_order_cash:{required:!0,validator:function(e,a,n){var r=t.subForm,i=r.empty_order_cash,s=r.coach_empty_cash,o=r.admin_empty_cash,c=/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;""===i||i&&!c.test(i)?n(new Error(""===i?"请输入空单费金额":"请输入正确的空单费金额，最多保留2位小数")):i&&""===s||s&&(!c.test(s)||1*s>100)?n(new Error(i&&""===s?"请输入"+t.$t("action.attendantName")+"获得空单费的比例":c.test(s)?t.$t("action.attendantName")+"获得空单费的比例不能大于100%":"请输入正确的"+t.$t("action.attendantName")+"获得空单费的比例，最多保留2位小数")):i&&""===o||o&&(!c.test(o)||1*o>100)?n(new Error(i&&""===o?"请输入"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得空单费的比例":c.test(o)?t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得空单费的比例不能大于100%":"请输入正确的"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得空单费的比例，最多保留2位小数")):s&&o&&1*s+1*o>100?n(new Error(t.$t("action.attendantName")+"与"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得空单费的比例总计不能大于100%")):n()},trigger:"blur"},after_service_can_refund:{required:!0,validator:function(e,a,n){var r=t.subForm.cash_list;if(1===a){for(var i in r){var s=1*i+1,o=r[i],c=o.minute,l=o.balance,m=s>1?r[1*i-1].minute:0;if(!c||!/^[1-9]\d*$/.test(c)||s>1&&1*c<=1*m){var _=c?/^[1-9]\d*$/.test(c)?"必须大于"+m+"分钟":"请输入正确的分钟数":"请输入分钟数";return void n(new Error("第"+s+"条数据："+_))}if(!l||!/^[0-9]\d*$/.test(l))return void n(new Error("第"+s+"条数据："+(l?"请输入正确的百分比":"请输入百分比")))}r.filter(function(t){return t.minute&&t.balance.length>0}).length===r.length&&n()}else n()},trigger:"blur"},coach_refund_comm:{required:!0,validator:function(e,a,n){var r=t.subForm,i=r.coach_refund_comm,s=r.admin_refund_comm,o=/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;""===i||i&&(!o.test(i)||1*i>100)?n(new Error(""===i?"请输入"+t.$t("action.attendantName")+"获得服务退款手续费的比例":o.test(i)?t.$t("action.attendantName")+"获得服务退款手续费的比例不能大于100%":"请输入正确的"+t.$t("action.attendantName")+"获得服务退款手续费的比例，最多保留2位小数")):""===s||s&&(!o.test(s)||1*s>100)?n(new Error(""===s?"请输入"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得服务退款手续费的比例":o.test(s)?t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得服务退款手续费的比例不能大于100%":"请输入正确的"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得服务退款手续费的比例，最多保留2位小数")):i&&s&&1*i+1*s>100?n(new Error(t.$t("action.attendantName")+"与"+t.$t("action.attendantName")+"所属"+t.$t("action.agentName")+"获得服务退款手续费的比例总计不能大于100%")):n()},trigger:"blur"},order_pay_timeout_remind:{required:!0,validator:this.$reg.isNum,reg_type:1,text:"分钟数",trigger:"blur"},order_time_confirm:{required:!0,type:"number",message:"请选择预约时间二次确认",trigger:"blur"},hide_order_user:{required:!0,type:"number",message:"请选择隐藏下单人信息",trigger:"blur"},hide_order_carfee:{required:!0,type:"number",message:"请选择隐藏车费明细",trigger:"blur"}}}},created:function(){this.getFormInfo()},computed:b()({},Object(f.e)({routesItem:function(t){return t.routes}})),methods:{getFormInfo:function(){var t=this;return v()(s.a.mark(function e(){var a,n,r,i,o,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.all([t.$api.system.configInfo(),t.$api.system.orderConfigInfo()]);case 2:for(l in a=e.sent,n=u()(a,2),r=n[0],i=n[1],0===(o=t.$util.pick(i.data,t.order)).cash_list.length&&(o.cash_list=[{minute:"",balance:""}]),r.data=c()({},r.data,o),t.subForm)t.subForm[l]=r.data[l];case 10:case"end":return e.stop()}},e,t)}))()},getFile:function(t,e){var a=t.length-1;this.subForm[e]=t[a].url},toResetFile:function(t){this.subForm[t]=""},toAddItem:function(t,e){var a=this;return v()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:2===t?a.subForm.cash_list.splice(e,1):a.subForm.cash_list.push({minute:"",balance:""});case 1:case"end":return n.stop()}},n,a)}))()},submitFormInfo:function(){var t=this;return v()(s.a.mark(function e(){var a,n,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,t.$refs.subForm.validate(function(t){t||(a=!1)}),a){e.next=4;break}return e.abrupt("return");case 4:return n=JSON.parse(r()(t.subForm)),i=t.$util.pick(n,t.order),t.order.map(function(t){delete n[t]}),e.next=9,m.a.all([t.$api.system.configUpdate(n),t.$api.system.orderConfigUpdate(i)]);case 9:t.$message.success(t.$t("tips.successSub"));case 10:case"end":return e.stop()}},e,t)}))()}},filters:{handleFileName:function(t){var e="请上传文件";return t&&(e=t.substring(t.lastIndexOf("/")+1)),e}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-system-other"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-form",{ref:"subForm",attrs:{model:t.subForm,rules:t.subFormRules,"label-width":"160px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"订单超时",prop:"over_time"}},[a("el-input",{attrs:{placeholder:"请输入分钟"},model:{value:t.subForm.over_time,callback:function(e){t.$set(t.subForm,"over_time",t._n(e))},expression:"subForm.over_time"}},[a("template",{slot:"append"},[t._v("分钟")])],2),t._v(" "),a("lb-tool-tips",[t._v("订单未支付超时时间，超时将自动取消订单，单位：分钟")])],1),t._v(" "),a("el-form-item",{attrs:{label:"时间间隔",prop:"time_interval"}},[a("el-input",{attrs:{placeholder:"请输入分钟"},model:{value:t.subForm.time_interval,callback:function(e){t.$set(t.subForm,"time_interval",t._n(e))},expression:"subForm.time_interval"}},[a("template",{slot:"append"},[t._v("分钟")])],2),t._v(" "),a("lb-tool-tips",[t._v(t._s(t.$t("action.attendantName"))+"结束上一单之后，与下一单的时间无间隔导致"+t._s(t.$t("action.attendantName"))+"不能赶到下一个服务点\n          "),a("div",{staticClass:"mt-sm"},[t._v("可设置订单间隔，例如设置订单间隔为30分钟")]),t._v(" "),a("div",{staticClass:"mt-sm"},[t._v("\n            上一个订单预约时间是14:00-15:00，则下一个用户预约同一个"+t._s(t.$t("action.attendantName"))+"的开始时间为15:30之后\n          ")])])],1),t._v(" "),a("el-form-item",{attrs:{label:"最长预约",prop:"max_day"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.subForm.max_day,callback:function(e){t.$set(t.subForm,"max_day",e)},expression:"subForm.max_day"}},t._l(t.longOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(" "),a("lb-tool-tips",[t._v("客户预约服务选择时间时可选择的时间期限")])],1),t._v(" "),a("el-form-item",{attrs:{label:"时长单位",prop:"time_unit"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.subForm.time_unit,callback:function(e){t.$set(t.subForm,"time_unit",e)},expression:"subForm.time_unit"}},t._l(t.timeOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),t._v(" "),a("lb-tool-tips",[t._v("划分工作时间的时间单位")])],1),t._v(" "),a("el-form-item",{attrs:{label:"服务开始语音",prop:"service_start_recording"}},[a("div",{staticClass:"flex-warp"},[a("div",{staticClass:"lb-file-input flex-between"},[a("div",{class:[{"c-title":t.subForm.service_start_recording}]},[t._v("\n              "+t._s(t._f("handleFileName")(t.subForm.service_start_recording))+"\n            ")]),t._v(" "),a("div",{staticClass:"flex-center"},[t.subForm.service_start_recording?a("i",{staticClass:"c-warning iconfont icon-guanbi-fill pl-sm pr-sm",on:{click:function(e){return t.toResetFile("service_start_recording")}}}):t._e(),t._v(" "),a("lb-cover",{attrs:{type:"button",fileType:"audio",fileSize:1},on:{selectedFiles:function(e){return t.getFile(e,"service_start_recording")}}})],1)]),t._v(" "),a("lb-tool-tips",[t._v("\n            当"+t._s(t.$t("action.attendantName"))+"点击开始服务时，自动播放此音频文件\n          ")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"服务结束倒计时语音",prop:"countdown_voice"}},[a("div",{staticClass:"flex-warp"},[a("div",{staticClass:"lb-file-input flex-between"},[a("div",{class:[{"c-title":t.subForm.countdown_voice}]},[t._v("\n              "+t._s(t._f("handleFileName")(t.subForm.countdown_voice))+"\n            ")]),t._v(" "),a("div",{staticClass:"flex-center"},[t.subForm.countdown_voice?a("i",{staticClass:"c-warning iconfont icon-guanbi-fill pl-sm pr-sm",on:{click:function(e){return t.toResetFile("countdown_voice")}}}):t._e(),t._v(" "),a("lb-cover",{attrs:{type:"button",fileType:"audio",fileSize:1},on:{selectedFiles:function(e){return t.getFile(e,"countdown_voice")}}})],1)]),t._v(" "),a("lb-tool-tips",[a("div",[t._v("\n              当"+t._s(t.$t("action.attendantName"))+"点击开始服务后，若订单服务总时长大于5分钟，则距离服务结束5分钟时，自动播放此音频文件\n            ")]),t._v(" "),a("div",{staticClass:"mt-md"},[t._v("\n              1）"+t._s(t.$t("action.attendantName"))+"停留在系统任一页面都可播放\n            ")]),t._v(" "),a("div",{staticClass:"mt-md"},[t._v("\n              2）如有多个订单点击开始服务，则按照时间先后依次播报，当第二个订单到达播报时间时，若第一个订单尚未播报完毕则暂停并重新播报\n            ")])])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"服务结束语音",prop:"service_end_recording"}},[a("div",{staticClass:"flex-warp"},[a("div",{staticClass:"lb-file-input flex-between"},[a("div",{staticClass:"ellipsis",class:[{"c-title":t.subForm.service_end_recording}]},[t._v("\n              "+t._s(t._f("handleFileName")(t.subForm.service_end_recording))+"\n            ")]),t._v(" "),a("div",{staticClass:"flex-center"},[t.subForm.service_end_recording?a("i",{staticClass:"c-warning iconfont icon-guanbi-fill pl-sm pr-sm",on:{click:function(e){return t.toResetFile("service_end_recording")}}}):t._e(),t._v(" "),a("lb-cover",{attrs:{type:"button",fileType:"audio",fileSize:1},on:{selectedFiles:function(e){return t.getFile(e,"service_end_recording")}}})],1)]),t._v(" "),a("lb-tool-tips",[t._v("\n            当"+t._s(t.$t("action.attendantName"))+"服务结束时，自动播放此音频文件\n          ")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"空单费",prop:"empty_order_cash"}},[a("div",[t._v("\n          "+t._s(t.$t("action.attendantName"))+"到达后，用户发起退款，需收取用户\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入金额"},model:{value:t.subForm.empty_order_cash,callback:function(e){t.$set(t.subForm,"empty_order_cash",e)},expression:"subForm.empty_order_cash"}}),t._v("\n          元空单费\n          "),a("lb-tool-tips",[t._v("空单费为固定金额，与订单支付金额大小无关\n            "),a("div",{staticClass:"mt-sm"},[t._v("\n              如果设置的空单费金额大于用户实际支付的金额，则会扣除订单全部的支付金额\n            ")]),t._v(" "),a("div",{staticClass:"mt-md"},[t._v("\n              空单费可按照比例分给"+t._s(t.$t("action.attendantName"))+"、"+t._s(t.$t("action.agentName"))+"、平台三方。"+t._s(t.$t("action.attendantName"))+"和"+t._s(t.$t("action.attendantName"))+"所属"+t._s(t.$t("action.agentName"))+"获得的比例总计不能大于100%\n            ")])])],1),t._v(" "),a("div",[t._v("\n          "+t._s(t.$t("action.attendantName"))+"获得空单费的\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入百分比"},model:{value:t.subForm.coach_empty_cash,callback:function(e){t.$set(t.subForm,"coach_empty_cash",e)},expression:"subForm.coach_empty_cash"}}),t._v("\n          %，"+t._s(t.$t("action.attendantName"))+"所属上级"+t._s(t.$t("action.agentName"))+"获得空单费的\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入百分比"},model:{value:t.subForm.admin_empty_cash,callback:function(e){t.$set(t.subForm,"admin_empty_cash",e)},expression:"subForm.admin_empty_cash"}}),t._v("\n          %\n        ")],1)]),t._v(" "),a("el-form-item",{attrs:{label:"用户订单退款",prop:"after_service_can_refund"}},[a("el-radio-group",{model:{value:t.subForm.after_service_can_refund,callback:function(e){t.$set(t.subForm,"after_service_can_refund",e)},expression:"subForm.after_service_can_refund"}},[a("el-radio",{attrs:{label:0}},[t._v("开始服务后不允许退款")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("开始服务后允许退款")])],1),t._v(" "),a("lb-tool-tips",[t._v("开始服务后不允许退款：订单在"+t._s(t.$t("action.attendantName"))+"点击开始服务后，用户则不能申请退款\n          "),a("div",{staticClass:"mt-sm"},[t._v("\n            开始服务后允许退款：订单在"+t._s(t.$t("action.attendantName"))+"开始服务后，订单完成前，用户都可以申请退款\n          ")])]),t._v(" "),1===t.subForm.after_service_can_refund?a("block",t._l(t.subForm.cash_list,function(e,n){return a("div",{key:n,staticClass:"mb-md"},[t._v("\n            服务过程中，前\n            "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入分钟"},model:{value:e.minute,callback:function(a){t.$set(e,"minute",a)},expression:"item.minute"}}),t._v("\n            分钟内退款，收取服务费的\n            "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入百分比"},model:{value:e.balance,callback:function(a){t.$set(e,"balance",a)},expression:"item.balance"}}),t._v("\n            %作为手续费扣除\n            "),0===n?a("lb-tool-tips",[t._v("\n              每个时间段发起退款，所收取的手续费不一样。例如：设置20分钟内收取50%，40分钟内收取80%，则表示：\n              "),a("div",{staticClass:"mt-sm"},[t._v("\n                如果用户是在服务过程中，前20分钟内（包含20分钟）发起退款，将会扣除服务费的50%，用户只能退回订单服务项目50%的费用\n              ")]),t._v(" "),a("div",{staticClass:"mt-sm"},[t._v("\n                如果用户是在服务过程中，第21分钟至40分钟内前发起退款，则扣除服务费的80%，用户只能退回订单服务项目20%的费用\n              ")])]):t._e(),t._v(" "),t.subForm.cash_list.length>1||1===t.subForm.cash_list.length&&0!==n?a("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"danger",size:"mini",plain:"",icon:"el-icon-delete"},on:{click:function(e){return t.toAddItem(2,n)}}},[t._v("删除")]):t._e(),t._v(" "),n===t.subForm.cash_list.length-1?a("lb-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-plus"},on:{click:function(e){return t.toAddItem(1)}}},[t._v("新增")]):t._e()],1)}),0):t._e()],1),t._v(" "),t.subForm.after_service_can_refund?a("el-form-item",{attrs:{label:"服务退款手续费",prop:"coach_refund_comm"}},[a("div",[t._v("\n          "+t._s(t.$t("action.attendantName"))+"获得\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入百分比"},model:{value:t.subForm.coach_refund_comm,callback:function(e){t.$set(t.subForm,"coach_refund_comm",e)},expression:"subForm.coach_refund_comm"}}),t._v("\n          %，"+t._s(t.$t("action.attendantName"))+"所属上级"+t._s(t.$t("action.agentName"))+"获得\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入百分比"},model:{value:t.subForm.admin_refund_comm,callback:function(e){t.$set(t.subForm,"admin_refund_comm",e)},expression:"subForm.admin_refund_comm"}}),t._v("\n          %"),a("lb-tool-tips",[t._v(t._s(t.$t("action.attendantName"))+"和"+t._s(t.$t("action.attendantName"))+"所属"+t._s(t.$t("action.agentName"))+"获得的比例总计不能大于100%，小于100%的，默认归属给平台\n          ")])],1)]):t._e(),t._v(" "),t.routesItem.auth.baiying?a("el-form-item",{attrs:{label:"订单支付超时提醒",prop:"order_pay_timeout_remind"}},[a("div",[t._v("\n          待支付订单在倒计时\n          "),a("el-input",{staticClass:"mini",attrs:{placeholder:"请输入"},model:{value:t.subForm.order_pay_timeout_remind,callback:function(e){t.$set(t.subForm,"order_pay_timeout_remind",e)},expression:"subForm.order_pay_timeout_remind"}}),t._v("\n          分钟未支付，则外呼通知用户"),a("lb-tool-tips",[t._v("下单人未输入支付密码的订单，在待支付订单倒计时为x分钟时，"),a("br"),t._v("还未支付，则触发百应外呼系统。输入0则表示不通知。\n          ")])],1)]):t._e(),t._v(" "),a("el-form-item",[a("lb-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:t.submitFormInfo}},[t._v(t._s(t.$t("action.submit")))])],1)],1)],1)],1)},staticRenderFns:[]};var F=a("C7Lr")(g,h,!1,function(t){a("ThSa")},"data-v-2155fc97",null);e.default=F.exports},ThSa:function(t,e){}});