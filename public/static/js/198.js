webpackJsonp([198],{R6er:function(e,t){},Spmz:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("p00s"),r=a.n(n),i=a("lC5x"),o=a.n(i),s=a("J0Oq"),l=a.n(s),c=a("4YfN"),u=a.n(c),d=a("3cXf"),m=a.n(d),p=a("PxTW"),h=a.n(p),_=a("bSIt"),f=a("Mpzp"),b={components:{sexEcharts:a("SOPO").default},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>1e3*(h()(h()(Date.now()).format("YYYY-MM-DD")).unix()+86400-1)}},isLoad:!1,downloadLoading:!1,rankInd:0,rankList:[{id:1,title:"今日"},{id:2,title:"昨日"},{id:3,title:"近7天"},{id:4,title:"近15天"}],loading:!1,searchForm:{page:1,limit:10,nickName:"",start_time:"",end_time:"",by_status:-2,city_area:[]},tableData:[],areaOptions:[],total:0,byStatus:{"-1":"未呼出",0:"已接听",1:"拒接",2:"无法接通",3:"主叫号码不可用",4:"空号",5:"关机",6:"占线",7:"停机",8:"未接",9:"主叫欠费",10:"呼损",11:"黑名单",12:"天盾拦截",22:"线路盲区",25:"无可用线路",100:"等待呼出"},byStatusList:[{id:-2,title:"全部"},{id:-1,title:"未呼出"},{id:0,title:"已接听"},{id:1,title:"拒接"},{id:2,title:"无法接通"},{id:3,title:"主叫号码不可用"},{id:4,title:"空号"},{id:5,title:"关机"},{id:6,title:"占线"},{id:7,title:"停机"},{id:8,title:"未接"},{id:9,title:"主叫欠费"},{id:10,title:"呼损"},{id:11,title:"黑名单"},{id:12,title:"天盾拦截"},{id:22,title:"线路盲区"},{id:25,title:"无可用线路"},{id:100,title:"等待呼出"}],phone_type:""}},created:function(){var e=JSON.parse(m()(f.regionData));e.map(function(e){if("500000"===e.value){var t=e.children[0].children,a=e.children[1].children;e.children[0].children=t.concat(a),e.children=[e.children[0]]}e.children.map(function(e){e.children&&e.children.length>0&&(e.children=e.children.filter(function(e){return"市辖区"!==e.label}))})}),this.areaOptions=e,this.initIndex()},computed:u()({},Object(_.e)({routesItem:function(e){return e.routes}})),methods:{initIndex:function(){var e=this;return l()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.getBySetting(),t.next=3,e.getTableDataList(1);case 3:e.isLoad=!0;case 4:case"end":return t.stop()}},t,e)}))()},getBySetting:function(){var e=this;return l()(o.a.mark(function t(){var a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.system.bySetting();case 2:if(a=t.sent,n=a.code,r=a.data,200===n){t.next=7;break}return t.abrupt("return");case 7:e.phone_type=r.phone_type;case 8:case"end":return t.stop()}},t,e)}))()},resetForm:function(e){this.rankInd=2,this.searchForm.time_type=3,this.$refs[e].resetFields(),this.getTableDataList(1)},handleSizeChange:function(e){this.searchForm.limit=e,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.searchForm.page=e,this.getTableDataList()},getTableDataList:function(e){var t=this;return l()(o.a.mark(function a(){var n,r,i,s,l,c,u,d,p,h;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e&&(t.searchForm.page=e),t.loading=!0,n=JSON.parse(m()(t.searchForm)),r=n.start_time,i=n.city_area,s=void 0===i?[]:i,r&&r.length>1?(n.start_time=r[0]/1e3,n.end_time=r[1]/1e3):(n.start_time="",n.end_time=""),s&&s.length>0&&(l=s[0],c=s.length>1?s[1]:"",u=s.length>2?s[2]:"",(c.includes("市辖区")||"重庆市"===l&&c.includes("县"))&&(c=l),l.includes("特别行政区")&&(u=c,c=l),c.includes("直辖县级行政区划")&&(c=u),n.province=l,n.city=c,n.area=u),delete n.city_area,n.by_status=-2===n.by_status?"":n.by_status,a.next=10,t.$api.survey.noPayRecordList(n);case 10:if(d=a.sent,p=d.code,h=d.data,t.loading=!1,200===p){a.next=16;break}return a.abrupt("return");case 16:t.tableData=h.data,t.total=h.total;case 18:case"end":return a.stop()}},a,t)}))()},toChangeItem:function(e,t){var a=this;return l()(o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:"rankInd"===e&&(r=a.rankList[t].id,a.searchForm.time_type=r,a.rankInd=t),a.getTableDataList(1);case 2:case"end":return n.stop()}},n,a)}))()},toExportExcel:function(){var e=this,t=this.total;if(t>1e4)this.$message.error("最多只能导出10000条数据，当前"+t+"条，请筛选数据点击搜索后再操作导出数据！");else{this.downloadLoading=!0;var a=JSON.parse(m()(this.searchForm)),n=a.start_time,i=a.city_area,o=void 0===i?[]:i;if(n&&n.length>1?(a.start_time=n[0]/1e3,a.end_time=n[1]/1e3):(a.start_time="",a.end_time=""),o&&o.length>0){var s=o[0],l=o.length>1?o[1]:"",c=o.length>2?o[2]:"";(l.includes("市辖区")||"重庆市"===s&&l.includes("县"))&&(l=s),s.includes("特别行政区")&&(c=l,l=s),l.includes("直辖县级行政区划")&&(l=c),a.province=s,a.city=l,a.area=c}delete a.city_area;var u=this.$util.getProCurrentHref(),d=u.indexOf("?")>0?"":"?",p=u.indexOf("?")>0;r()(a).forEach(function(e,t){d+=p?"&"+e+"="+a[e]:e+"="+a[e],p=!0});var h=window.localStorage.getItem("massage_minitk"),_=u+"/massage/admin/AdminExcel/noPayRecordList"+d+"&token="+h;window.location.href=_,setTimeout(function(){e.downloadLoading=!1},5e3)}},toOutbound:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$confirm(this.$t("tips.confirmOperate"),this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(l()(o.a.mark(function a(){var n,r,i,s,l,c,d,p;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=JSON.parse(m()(e.searchForm)),r=n.start_time,i=n.city_area,s=void 0===i?[]:i,r&&r.length>1?(n.start_time=r[0]/1e3,n.end_time=r[1]/1e3):(n.start_time="",n.end_time=""),s&&s.length>0&&(l=s[0],c=s.length>1?s[1]:"",d=s.length>2?s[2]:"",(c.includes("市辖区")||"重庆市"===l&&c.includes("县"))&&(c=l),l.includes("特别行政区")&&(d=c,c=l),c.includes("直辖县级行政区划")&&(c=d),n.province=l,n.city=c,n.area=d),delete n.city_area,a.next=7,e.$api.survey.outbound(u()({id:t},n));case 7:if(p=a.sent,200===p.code){a.next=11;break}return a.abrupt("return");case 11:e.$message.success(e.$t("tips.successOper"));case 12:case"end":return a.stop()}},a,e)}))).catch(function(){})}},filters:{handleTime:function(e,t){return 1===t?h()(1e3*e).format("YYYY-MM-DD"):2===t?h()(1e3*e).format("HH:mm:ss"):h()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:!e.isLoad,expression:"!isLoad"}],staticClass:"lb-data-index"},[a("top-nav"),e._v(" "),a("div",{staticClass:"page-main"},[a("lb-tips",[e._v("仅统计用户点击提交订单进入下单页面后未点击「立即支付」按钮的埋点数据，其余不统计")]),e._v(" "),a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.searchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"nickName"}},[a("el-input",{attrs:{placeholder:"请输入微信昵称"},model:{value:e.searchForm.nickName,callback:function(t){e.$set(e.searchForm,"nickName",t)},expression:"searchForm.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp","picker-options":e.pickerOptions,"default-time":["00:00:00","23:59:59"]},on:{change:function(t){return e.getTableDataList(1)}},model:{value:e.searchForm.start_time,callback:function(t){e.$set(e.searchForm,"start_time",t)},expression:"searchForm.start_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在地区",prop:"city_area"}},[a("el-cascader",{attrs:{size:"large",clearable:"",options:e.areaOptions,placeholder:"请选择客户所在地区",props:{checkStrictly:!0,value:"label"}},on:{change:function(t){return e.getTableDataList(1,"list")}},model:{value:e.searchForm.city_area,callback:function(t){e.$set(e.searchForm,"city_area",t)},expression:"searchForm.city_area"}})],1),e._v(" "),e.routesItem.auth.baiying&&e.routesItem.userInfo.is_admin?a("el-form-item",{attrs:{label:"状态",prop:"by_status"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择状态"},on:{change:function(t){return e.getTableDataList(1)}},model:{value:e.searchForm.by_status,callback:function(t){e.$set(e.searchForm,"by_status",t)},expression:"searchForm.by_status"}},e._l(e.byStatusList,function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}),1)],1):e._e(),e._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTableDataList(1)}}},[e._v(e._s(e.$t("action.search")))]),e._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v(e._s(e.$t("action.reset")))])],1)],1)],1),e._v(" "),a("el-row",{staticClass:"page-top-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:e.$route.name+"-export",expression:"`${$route.name}-export`"}],attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:e.toExportExcel}},[e._v("\n        "+e._s(e.$t("action.export")))]),e._v(" "),a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:e.$route.name+"-outbound",expression:"`${$route.name}-outbound`"},{name:"show",rawName:"v-show",value:1==e.phone_type,expression:"phone_type == 1"}],attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-phone-outline"},on:{click:e.toOutbound}},[e._v("\n        "+e._s(e.$t("action.outbound")))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_id",label:"用户ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avatarUrl",label:"微信头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"微信昵称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"province",label:"所属地区","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s((t.row.province||"")+" "+(t.row.city||"")+" "+(t.row.area||""))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"order_count",label:"消费次数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"coach_name",label:"预约"+e.$t("action.attendantName"),"min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goods_name",label:"加购服务","min-width":"200"}}),e._v(" "),e.routesItem.auth.baiying&&e.routesItem.userInfo.is_admin?a("el-table-column",{attrs:{prop:"by_status",label:"外呼状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(e.byStatus[t.row.by_status]))])]}}],null,!1,842986309)}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"操作时间","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(e._f("handleTime")(t.row.create_time,1)))]),e._v(" "),a("p",[e._v(e._s(e._f("handleTime")(t.row.create_time,2)))])]}}])},[a("template",{slot:"header"},[a("div",{staticStyle:{"margin-top":"7px",padding:"0"}},[e._v("\n            操作时间"),a("lb-tool-tips",{attrs:{padding:"10"}},[e._v("用户进入下单页面，未点击「立即支付」创建订单就退出当前页面的时间")])],1)])],2),e._v(" "),e.routesItem.auth.baiying&&e.routesItem.userInfo.is_admin&&1==e.phone_type?a("el-table-column",{attrs:{label:"操作",width:"110",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:e.$route.name+"-outboundCall",expression:"`${$route.name}-outboundCall`"}],attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return e.toOutbound(t.row.id)}}},[e._v(e._s(e.$t("action.outboundCall")))])],1)]}}],null,!1,2620187560)}):e._e()],1),e._v(" "),a("lb-page",{attrs:{batch:!1,page:e.searchForm.page,pageSize:e.searchForm.limit,total:e.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var g=a("C7Lr")(b,v,!1,function(e){a("R6er")},"data-v-029227fc",null);t.default=g.exports}});