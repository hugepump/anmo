webpackJsonp([187],{Izx2:function(t,e){},leYY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("lC5x"),r=a.n(n),i=a("3cXf"),o=a.n(i),s=a("J0Oq"),c=a.n(s),l=a("4YfN"),u=a.n(l),m=a("bSIt"),d=a("PxTW"),h=a.n(d),f={data:function(){return{statusType:{"-1":"删除",0:"到期",1:"商家待签署",2:"待"+this.$t("action.attendantName")+"签署",3:"已完成",4:"履约中"},loading:{list:!1,coach:!1},searchForm:{list:{page:1,limit:10,name:""},coach:{page:1,limit:10,coach_name:""}},tableData:{list:[],coach:[]},total:{list:0,coach:0},currentRow:{},showDialog:!1,activeName:"contract",contract:[],commitment:[]}},activated:function(){this.getTableDataList(1,"list")},computed:u()({},Object(m.e)({routesItem:function(t){return t.routes}})),methods:{resetForm:function(t){var e=t+"Form";this.$refs[e].resetFields(),this.getTableDataList(1,t)},handleSizeChange:function(t,e){this.searchForm[e].limit=t,this.handleCurrentChange(1,e)},handleCurrentChange:function(t,e){this.searchForm[e].page=t,this.getTableDataList("",e)},getTableDataList:function(t,e){var a=this;return c()(r.a.mark(function n(){var i,s,c,l,u,m,d;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t&&(a.searchForm[e].page=t),a.tableData[e]=[],a.loading[e]=!0,i=JSON.parse(o()(a.searchForm[e])),s={list:{methodKey:"system",methodModel:"fxqGetContractList"},coach:{methodKey:"system",methodModel:"noAgreementCoach"}}[e],c=s.methodKey,l=s.methodModel,n.next=8,a.$api[c][l](i);case 8:if(u=n.sent,m=u.code,d=u.data,a.loading[e]=!1,200===m){n.next=14;break}return n.abrupt("return");case 14:a.tableData[e]=d.data,a.total[e]=d.total;case 16:case"end":return n.stop()}},n,a)}))()},confirmDel:function(t,e){var a=this,n=e>2?"已签约合同":"已发起合同",r=this.$createElement;this.$confirm(r("p",null,[r("p",null,"你确认要删除吗？"),r("p",{style:"font-size:13px;line-height:1.2;color: red"},"删除后，"+n+"将作废！")]),this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){a.updateItem(t,-1,"list")}).catch(function(){})},updateItem:function(t,e,a){var n=this;return c()(r.a.mark(function i(){return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.$api.system.fxqDelContract({id:t}).then(function(t){if(200===t.code)n.$message.success(n.$t(-1===e?"tips.successDel":"tips.successOper")),-1===e&&(n.searchForm[a].page=n.searchForm[a].page<Math.ceil((n.total[a]-1)/n.searchForm[a].limit)?n.searchForm[a].page:Math.ceil((n.total[a]-1)/n.searchForm[a].limit),n.getTableDataList("",a));else{if(-1===e)return;n.getTableDataList("",a)}});case 1:case"end":return r.stop()}},i,n)}))()},toFddAuth:function(t){var e=this;return c()(r.a.mark(function a(){var n,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading.list=!0,a.next=3,e.$api.system.fxqCompanySign({id:t});case 3:if(n=a.sent,i=n.code,n.data,e.loading.list=!1,200===i){a.next=9;break}return a.abrupt("return");case 9:e.$message.success(e.$t("tips.successOper")),e.getTableDataList(1,"list");case 11:case"end":return a.stop()}},a,e)}))()},toFddUrl:function(t){window.open(t)},toShowDialog:function(t,e){var a=this;return c()(r.a.mark(function n(){var i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=JSON.parse(o()(t)),i=t[e].coach_view_contract||t[e].company_view_contract,window.open(i);case 3:case"end":return a.stop()}},n,a)}))()},handleClick:function(t){console.log(t,"==========> ");var e=t.name;this.activeName=e},handleSelectionChange:function(t){this.currentRow=t},handleDialogConfirm:function(){var t=this;return c()(r.a.mark(function e(){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t.currentRow&&t.currentRow.id){e.next=3;break}return t.$message.error("请选择"+t.$t("action.attendantName")),e.abrupt("return");case 3:return a=t.currentRow.id,e.next=6,t.$api.system.fxqAddContract({coach_id:a});case 6:if(n=e.sent,i=n.code,n.data,200===i){e.next=11;break}return e.abrupt("return");case 11:if(t.showDialog){e.next=13;break}return e.abrupt("return");case 13:t.showDialog=!1,t.getTableDataList(1,"list");case 15:case"end":return e.stop()}},e,t)}))()}},filters:{handleTime:function(t,e){return 1===e?h()(1e3*t).format("YYYY-MM-DD"):2===e?h()(1e3*t).format("HH:mm:ss"):h()(1e3*t).format("YYYY-MM-DD HH:mm:ss")}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-system-fdd-record"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"listForm",attrs:{inline:!0,model:t.searchForm.list},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入"+t.$t("action.attendantName")+"姓名"},model:{value:t.searchForm.list.name,callback:function(e){t.$set(t.searchForm.list,"name",e)},expression:"searchForm.list.name"}})],1),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1,"list")}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("list")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.list,expression:"loading.list"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.list,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"coach_id",label:t.$t("action.attendantName")+"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"coach_name",label:t.$t("action.attendantName")+"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id_code",label:"身份证号","min-width":"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"合同状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.statusType[e.row.status])+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("handleTime")(e.row.create_time,1)))]),t._v(" "),a("p",[t._v(t._s(t._f("handleTime")(e.row.create_time,2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"到期时间","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.end_time?a("div",[a("p",[t._v(t._s(t._f("handleTime")(e.row.end_time,1)))]),t._v(" "),a("p",[t._v(t._s(t._f("handleTime")(e.row.end_time,2)))])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-operate"},[a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-fddSignUrl",expression:"`${$route.name}-fddSignUrl`"},{name:"show",rawName:"v-show",value:e.row.file_list[0].coach_view_contract||e.row.file_list[0].company_view_contract,expression:"\n                scope.row.file_list[0].coach_view_contract ||\n                scope.row.file_list[0].company_view_contract\n              "}],attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.toShowDialog(e.row.file_list,0)}}},[t._v(t._s(t.$t("action.fddSignUrl")))]),t._v(" "),a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-fddLetterUrl",expression:"`${$route.name}-fddLetterUrl`"},{name:"show",rawName:"v-show",value:e.row.file_list[1]&&(e.row.file_list[1].coach_view_contract||e.row.file_list[1].company_view_contract),expression:"\n                scope.row.file_list[1] &&\n                (scope.row.file_list[1].coach_view_contract ||\n                  scope.row.file_list[1].company_view_contract)\n              "}],attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.toShowDialog(e.row.file_list,1)}}},[t._v(t._s(t.$t("action.fddLetterUrl")))]),t._v(" "),a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-fddMerchantSign",expression:"`${$route.name}-fddMerchantSign`"},{name:"show",rawName:"v-show",value:1===e.row.status,expression:"scope.row.status === 1"}],attrs:{size:"mini",plain:"",type:"success"},on:{click:function(a){return t.toFddAuth(e.row.id)}}},[t._v(t._s(t.$t("action.fddMerchantSign")))]),t._v(" "),a("lb-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:t.$route.name+"-delete",expression:"`${$route.name}-delete`"}],attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return t.confirmDel(e.row.id,e.row.status)}}},[t._v(t._s(t.$t("action.delete")))])],1)]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.list.page,pageSize:t.searchForm.list.limit,total:t.total.list},on:{handleSizeChange:function(e){return t.handleSizeChange(e,"list")},handleCurrentChange:function(e){return t.handleCurrentChange(e,"list")}}}),t._v(" "),a("el-dialog",{attrs:{title:"",visible:t.showDialog,width:"800px",top:"5vh",center:""},on:{"update:visible":function(e){t.showDialog=e}}},[a("el-row",{staticClass:"page-search-form"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"合同",name:"contract"}},t._l(t.contract,function(t,e){return a("block",{key:e},[a("img",{staticStyle:{width:"100%"},attrs:{src:t,alt:""}})])}),1),t._v(" "),a("el-tab-pane",{attrs:{label:"承诺书",name:"commitment"}},t._l(t.commitment,function(t,e){return a("block",{key:e},[a("img",{staticStyle:{width:"100%"},attrs:{src:t,alt:""}})])}),1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("关 闭")])],1)],1)],1)],1)},staticRenderFns:[]};var v=a("C7Lr")(f,p,!1,function(t){a("Izx2")},"data-v-112a7833",null);e.default=v.exports}});