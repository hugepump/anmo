webpackJsonp([52],{HUBZ:function(e,t){},"Ot/s":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("rVsN"),i=s.n(a),n=s("KH7x"),o=s.n(n),r=s("4YfN"),l=s.n(r),c=s("lC5x"),u=s.n(c),p=s("J0Oq"),m=s.n(p),b=s("bSIt"),v={data:function(){return{activeName:"user",isSubmit:!1,isSubmitStatus:0,fileName:"",selectOptions:[],selectOptions1:[],subForm:{app_id:[],key:"",version:"",content:"",wxapp_version:"",coach_key:"",coach_version:"",coach_content:"",coach_wxapp_version:""},subFormRules:{key:{required:!0,type:"string",message:"请上传密钥",trigger:["change","blur"]},wxapp_version:{required:!0,type:"string",message:"请选择小程序代码版本",trigger:["change","blur"]},coach_key:{required:!0,type:"string",message:"请上传密钥",trigger:["change","blur"]},coach_wxapp_version:{required:!0,type:"string",message:"请选择小程序代码版本",trigger:["change","blur"]}}}},created:function(){var e=this;return m()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getBaseInfo();case 2:case"end":return t.stop()}},t,e)}))()},computed:l()({},Object(b.e)({routesItem:function(e){return e.routes}})),methods:{getBaseInfo:function(){var e=this;return m()(u.a.mark(function t(){var s,a,n,r,l,c;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.all([e.$api.system.wxappVersion(),e.$api.system.wxUploadInfo()]);case 2:for(c in s=t.sent,a=o()(s,2),n=a[0],r=a[1],l=n.data.map(function(e){return{key:e}}),e.selectOptions=l.filter(function(e){return!e.key.includes("技师端")}),e.selectOptions1=l.filter(function(e){return e.key.includes("技师端")}),e.subForm)e.subForm[c]=r.data[c]||"";case 10:case"end":return t.stop()}},t,e)}))()},handleClose:function(){this.isSubmit=!1},getFile:function(e,t){var s=e.length-1;this.subForm[t]=e[s].url},toResetFile:function(e){this.subForm[e]=""},handleClick:function(e){var t=e.name;this.activeName=t},submitFormInfo:function(e){var t=this;if(1!==this.isSubmitStatus){var s=!0;if(this.$refs[e].validate(function(e){e||(s=!1)}),s){var a="user"===this.activeName,i=this.$util.pick(this.subForm,a?["app_id","key","version","content"]:["app_id","coach_key","coach_version","coach_content"]),n=this.$util.pick(this.subForm,a?["wxapp_version"]:["coach_wxapp_version"]);this.$api.system.wxUploadUpdate(i).then(function(e){if(200===e.code){t.isSubmit=!0,t.isSubmitStatus=1;var s=a?"uploadWxapp":"uploadWxappCoach";t.$api.system[s](n).then(function(e){t.isSubmit=!1,t.isSubmitStatus=0,e.data.msg&&t.$message({type:2e4===e.data.code?"success":"error",message:e.data.msg,duration:0,showClose:!0})})}})}}else this.isSubmit=!0}},filters:{handleFileName:function(e){var t="请上传文件";return e&&(t=e.substring(e.lastIndexOf("/")+1)),t}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lb-system-examine"},[s("top-nav"),e._v(" "),s("div",{staticClass:"page-main"},[e.routesItem.auth.coachport?s("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"用户端",name:"user"}}),e._v(" "),s("el-tab-pane",{attrs:{label:e.$t("action.attendantName")+"端",name:"technician"}})],1):e._e(),e._v(" "),s("el-form",{ref:"subForm",staticClass:"config-form",attrs:{model:e.subForm,rules:e.subFormRules,"label-width":"160px"},nativeOn:{submit:function(e){e.preventDefault()}}},["user"===e.activeName?s("block",[s("el-form-item",{attrs:{label:"代码上传密钥",prop:"key"}},[s("div",{staticClass:"flex-warp"},[s("div",{staticClass:"lb-file-input flex-between"},[s("div",{class:[{"c-title":e.subForm.key}]},[e._v("\n                "+e._s(e._f("handleFileName")(e.subForm.key))+"\n              ")]),e._v(" "),s("div",{staticClass:"flex-center"},[e.subForm.key?s("i",{staticClass:"c-warning iconfont icon-guanbi-fill pl-sm pr-sm",on:{click:function(t){return e.toResetFile("key")}}}):e._e(),e._v(" "),s("lb-cover",{attrs:{type:"button",fileType:"wxuploadkey",fileSize:1},on:{selectedFiles:function(t){return e.getFile(t,"key")}}})],1)])])]),e._v(" "),s("el-form-item",{attrs:{label:"版本号",prop:"version"}},[s("el-input",{attrs:{type:"text",maxlength:"30","show-word-limit":"",placeholder:"请输入版本号"},model:{value:e.subForm.version,callback:function(t){e.$set(e.subForm,"version",t)},expression:"subForm.version"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"版本描述",prop:"content"}},[s("el-input",{attrs:{type:"text",maxlength:"30","show-word-limit":"",placeholder:"请输入版本描述"},model:{value:e.subForm.content,callback:function(t){e.$set(e.subForm,"content",t)},expression:"subForm.content"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"小程序代码版本",prop:"wxapp_version"}},[s("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.subForm.wxapp_version,callback:function(t){e.$set(e.subForm,"wxapp_version",t)},expression:"subForm.wxapp_version"}},e._l(e.selectOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.key,value:e.key}})}),1)],1)],1):e._e(),e._v(" "),"technician"===e.activeName?s("block",[s("el-form-item",{attrs:{label:"代码上传密钥",prop:"coach_key"}},[s("div",{staticClass:"flex-warp"},[s("div",{staticClass:"lb-file-input flex-between"},[s("div",{class:[{"c-title":e.subForm.coach_key}]},[e._v("\n                "+e._s(e._f("handleFileName")(e.subForm.coach_key))+"\n              ")]),e._v(" "),s("div",{staticClass:"flex-center"},[e.subForm.coach_key?s("i",{staticClass:"c-warning iconfont icon-guanbi-fill pl-sm pr-sm",on:{click:function(t){return e.toResetFile("coach_key")}}}):e._e(),e._v(" "),s("lb-cover",{attrs:{type:"button",fileType:"wxuploadkey",fileSize:1},on:{selectedFiles:function(t){return e.getFile(t,"coach_key")}}})],1)])])]),e._v(" "),s("el-form-item",{attrs:{label:"版本号",prop:"coach_version"}},[s("el-input",{attrs:{type:"text",maxlength:"30","show-word-limit":"",placeholder:"请输入版本号"},model:{value:e.subForm.coach_version,callback:function(t){e.$set(e.subForm,"coach_version",t)},expression:"subForm.coach_version"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"版本描述",prop:"coach_content"}},[s("el-input",{attrs:{type:"text",maxlength:"30","show-word-limit":"",placeholder:"请输入版本描述"},model:{value:e.subForm.coach_content,callback:function(t){e.$set(e.subForm,"coach_content",t)},expression:"subForm.coach_content"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"小程序代码版本",prop:"coach_wxapp_version"}},[s("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.subForm.coach_wxapp_version,callback:function(t){e.$set(e.subForm,"coach_wxapp_version",t)},expression:"subForm.coach_wxapp_version"}},e._l(e.selectOptions1,function(e){return s("el-option",{key:e.key,attrs:{label:e.key,value:e.key}})}),1)],1)],1):e._e(),e._v(" "),s("el-form-item",[s("lb-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary"},on:{click:function(t){return e.submitFormInfo("subForm")}}},[e._v(e._s(e.$t("action.submit")))])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"温馨提示",visible:e.isSubmit,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.isSubmit=t}}},[s("div",{staticClass:"flex-center"},[s("div",{staticClass:"el-icon-loading",staticStyle:{"font-size":"20px"}}),e._v(" "),s("div",{staticClass:"flex-1 mr-lg",staticStyle:{display:"inline-block"}},[e._v("\n          代码正在上传中，请耐心等待！\n        ")])]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isSubmit=!1}}},[e._v("知道了")])],1)])],1)],1)},staticRenderFns:[]};var d=s("C7Lr")(v,f,!1,function(e){s("HUBZ")},"data-v-b3f59e44",null);t.default=d.exports}});